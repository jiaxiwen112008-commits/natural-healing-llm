<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>MindGarden - 基于自然疗愈的学生压力干预AI平台</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            scroll-behavior: smooth;
            -webkit-text-size-adjust: 100%;
        }

        body {
            font-family: 'Poppins', 'Noto Sans SC', sans-serif;
            background-color: #F9FBF7;
            background-image: linear-gradient(to bottom, rgba(137, 195, 74, 0.05), rgba(100, 181, 246, 0.05));
            min-height: 100vh;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
        }

        /* 自然主题配色 */
        :root {
            --primary-green: #689F38;
            --light-green: #8BC34A;
            --dark-green: #558B2F;
            --sky-blue: #64B5F6;
            --light-blue: #90CAF9;
            --dark-blue: #42A5F5;
            --sun-yellow: #FFEE58;
            --light-yellow: #FFF59D;
            --flower-pink: #F48FB1;
            --light-pink: #F8BBD0;
            --text-primary: #2E3B2E;
            --text-secondary: #5C6D63;
            --text-disabled: #A5B1A6;
            --bg-default: #F9FBF7;
            --bg-paper: #FFFFFF;
        }

        /* 导航栏 */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-green);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-menu a {
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-menu a:hover,
        .nav-menu a.active {
            color: var(--primary-green);
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-primary);
            cursor: pointer;
        }

        /* 主要内容区域 */
        .main-content {
            margin-top: 70px;
            min-height: calc(100vh - 70px);
        }

        /* 页面容器 */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* 英雄区域 */
        .hero {
            background: linear-gradient(135deg, var(--light-green), var(--light-blue));
            padding: 6rem 0;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="40" r="1.5" fill="rgba(255,255,255,0.1)"/><circle cx="40" cy="80" r="1" fill="rgba(255,255,255,0.1)"/></svg>');
            animation: float 20s infinite linear;
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            100% { transform: translateY(-100px); }
        }

        .hero-content {
            position: relative;
            z-index: 2;
            max-width: 800px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .hero h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #fff, #e8f5e8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        /* 按钮样式 */
        .btn {
            display: inline-block;
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 1rem;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary-green), var(--sky-blue));
            color: white;
            box-shadow: 0 4px 15px rgba(104, 159, 56, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(104, 159, 56, 0.4);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary-green);
            border: 2px solid var(--primary-green);
        }

        .btn-outline:hover {
            background: var(--primary-green);
            color: white;
        }

        /* 卡片样式 */
        .card {
            background: var(--bg-paper);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            padding: 2rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
        }

        /* 容器 */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .section {
            padding: 4rem 0;
        }

        /* 网格布局 */
        .grid {
            display: grid;
            gap: 2rem;
        }

        .grid-2 {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .grid-3 {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        /* 评估页面样式 */
        .assessment-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 3rem;
        }

        .step {
            display: flex;
            align-items: center;
            margin: 0 1rem;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--light-green);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-right: 0.5rem;
        }

        .step.active .step-number {
            background: var(--primary-green);
        }

        .step.completed .step-number {
            background: var(--sky-blue);
        }

        /* 表单样式 */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-green);
        }

        .form-control.error {
            border-color: var(--flower-pink);
        }

        /* 问卷选项 */
        .question {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--bg-paper);
            border-radius: 8px;
            border-left: 4px solid var(--primary-green);
        }

        .question h3 {
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.5rem;
        }

        .option-btn {
            padding: 12px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .option-btn:hover {
            border-color: var(--primary-green);
            background: rgba(104, 159, 56, 0.05);
        }

        .option-btn.selected {
            border-color: var(--primary-green);
            background: var(--primary-green);
            color: white;
        }

        /* 结果页面 */
        .result-card {
            background: linear-gradient(135deg, var(--light-green), var(--light-blue));
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
        }

        .stress-level {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .intervention-card {
            background: var(--bg-paper);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid var(--primary-green);
        }

        /* 聊天界面 */
        .chat-container {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            height: 300px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            background: #f9f9f9;
        }

        .message {
            margin-bottom: 1rem;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            max-width: 80%;
        }

        .message.user {
            background: var(--light-blue);
            color: white;
            margin-left: auto;
        }

        .message.bot {
            background: white;
            border: 1px solid #e0e0e0;
        }

        .chat-input {
            display: flex;
            padding: 1rem;
            border-top: 1px solid #e0e0e0;
        }

        .chat-input input {
            flex: 1;
            padding: 0.5rem;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            margin-right: 0.5rem;
        }

        /* 干预实验室 */
        .intervention-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .intervention-card {
            background: var(--bg-paper);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }

        .intervention-card:hover {
            transform: translateY(-5px);
        }

        .intervention-image {
            height: 200px;
            background: linear-gradient(135deg, var(--light-green), var(--light-blue));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: white;
        }

        .intervention-content {
            padding: 1.5rem;
        }

        .intervention-content h3 {
            color: var(--text-primary);
            margin-bottom: 1rem;
        }

        .intervention-content p {
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .benefits {
            list-style: none;
        }

        .benefits li {
            padding: 0.25rem 0;
            color: var(--text-secondary);
        }

        .benefits li::before {
            content: '✓';
            color: var(--primary-green);
            font-weight: bold;
            margin-right: 0.5rem;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            /* 导航栏 */
            .nav-container {
                padding: 0 15px;
            }

            .nav-menu {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: rgba(255, 255, 255, 0.98);
                flex-direction: column;
                padding: 1rem 0;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
                gap: 0;
            }

            .nav-menu.active {
                display: flex;
            }

            .nav-menu li {
                width: 100%;
            }

            .nav-menu a {
                display: block;
                padding: 1rem 1.5rem;
                border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            }

            .nav-menu a:hover,
            .nav-menu a.active {
                background: rgba(104, 159, 56, 0.1);
            }

            .mobile-menu-btn {
                display: block;
            }

            .logo {
                font-size: 1.2rem;
            }

            /* Hero区域 */
            .hero {
                padding: 3rem 0;
            }

            .hero h1 {
                font-size: 1.8rem;
                line-height: 1.3;
            }

            .hero p {
                font-size: 0.95rem;
                padding: 0 10px;
            }

            .hero-content > div {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 0.75rem;
            }

            .hero .btn {
                display: block;
                width: 80%;
                max-width: 250px;
                margin: 0 !important;
                text-align: center;
            }

            /* 容器和间距 */
            .container {
                padding: 0 15px;
            }

            .section {
                padding: 2.5rem 0;
            }

            /* 网格布局 */
            .grid-2,
            .grid-3 {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            /* 卡片 */
            .card {
                padding: 1.5rem;
            }

            .card h3 {
                font-size: 1.1rem;
            }

            /* 评估页面 */
            .assessment-container {
                padding: 1rem;
            }

            .step-indicator {
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .step {
                margin: 0;
                font-size: 0.85rem;
            }

            .step-number {
                width: 32px;
                height: 32px;
                font-size: 0.9rem;
            }

            .step span {
                display: none;
            }

            .question {
                padding: 1rem;
                margin-bottom: 1.5rem;
            }

            .question h3 {
                font-size: 1rem;
                line-height: 1.5;
            }

            .options {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }

            .option-btn {
                padding: 14px 12px;
                font-size: 0.95rem;
                text-align: center;
            }

            .form-group label {
                font-size: 0.95rem;
            }

            .form-control {
                padding: 14px 12px;
                font-size: 16px; /* 防止iOS缩放 */
            }

            textarea.form-control {
                min-height: 120px;
            }

            /* 按钮 */
            .btn {
                padding: 14px 20px;
                font-size: 1rem;
                width: 100%;
            }

            #prev-btn, #next-btn {
                width: auto;
                min-width: 120px;
            }

            /* 干预卡片 */
            .intervention-grid {
                grid-template-columns: 1fr;
            }

            .intervention-image {
                height: 150px;
                font-size: 2.5rem;
            }

            .intervention-content {
                padding: 1.25rem;
            }

            .intervention-content h3 {
                font-size: 1.1rem;
            }

            .benefits li {
                font-size: 0.9rem;
                padding: 0.3rem 0;
            }

            /* 结果页面 */
            .result-card {
                padding: 1.5rem;
            }

            .stress-level {
                font-size: 1.5rem;
            }

            /* 聊天界面 */
            .chat-container {
                height: 350px;
            }

            .chat-messages {
                padding: 0.75rem;
            }

            .message {
                max-width: 90%;
                font-size: 0.95rem;
            }

            .chat-input {
                padding: 0.75rem;
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .chat-input input {
                flex: 1 1 100%;
                padding: 12px;
                font-size: 16px;
                margin-right: 0;
            }

            .chat-input button {
                width: 100%;
            }

            /* 页脚 */
            .footer {
                padding: 1.5rem 0;
                margin-top: 2rem;
            }

            .footer p {
                font-size: 0.9rem;
            }

            /* 数据统计卡片 - 移动端2x2布局 */
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
            }

            .stat-item {
                padding: 0.75rem 0.5rem;
            }

            .stat-number {
                font-size: 1.4rem;
            }

            .stat-label {
                font-size: 0.7rem;
            }
        }

        /* 更小屏幕的额外优化 */
        @media (max-width: 480px) {
            .hero h1 {
                font-size: 1.5rem;
            }

            .hero p {
                font-size: 0.9rem;
            }

            .card {
                padding: 1.25rem;
            }

            .question h3 {
                font-size: 0.95rem;
            }

            .step-indicator {
                justify-content: space-around;
            }

            .step {
                flex-direction: column;
                align-items: center;
            }

            .step-number {
                margin-right: 0;
                margin-bottom: 0.25rem;
            }

            .intervention-image {
                height: 120px;
                font-size: 2rem;
            }
        }

        /* 触摸设备优化 */
        @media (hover: none) and (pointer: coarse) {
            .option-btn:hover {
                border-color: #e0e0e0;
                background: white;
                transform: none;
            }

            .option-btn.selected:hover {
                border-color: var(--primary-green);
                background: var(--primary-green);
            }

            .btn:hover {
                transform: none;
            }

            .card:hover {
                transform: none;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            }

            .intervention-card:hover {
                transform: none;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            }

            .stat-item:hover {
                transform: none;
            }

            .stat-item:hover .stat-number {
                transform: none;
            }

            /* 保留淡入动画但简化 */
            .animate-on-scroll.animated {
                animation-duration: 0.4s;
            }
        }

        /* 横屏模式优化 */
        @media (max-height: 500px) and (orientation: landscape) {
            .hero {
                padding: 2rem 0;
            }

            .hero h1 {
                font-size: 1.5rem;
                margin-bottom: 0.5rem;
            }

            .section {
                padding: 1.5rem 0;
            }
        }

        /* 减少动画偏好 - 无障碍支持 */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }

            .animate-on-scroll {
                opacity: 1;
            }
        }

        /* 加载动画 */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* 隐藏类 */
        .hidden {
            display: none !important;
        }

        /* 页脚 */
        .footer {
            background: var(--text-primary);
            color: white;
            padding: 2rem 0;
            text-align: center;
            margin-top: 4rem;
        }

        .footer p {
            margin-bottom: 0.5rem;
        }

        /* 统计数据网格 */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .stat-item {
            text-align: center;
            padding: 1rem 0.5rem;
            border-radius: 8px;
        }

        .stat-number {
            font-size: 1.75rem;
            font-weight: 700;
            line-height: 1.2;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        /* 动画效果 */
        
        /* 淡入动画 */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* 滚动触发动画类 */
        .animate-on-scroll {
            opacity: 0;
        }

        .animate-on-scroll.animated {
            animation-duration: 0.6s;
            animation-fill-mode: both;
            animation-timing-function: ease-out;
        }

        .animate-on-scroll.animated.fade-up {
            animation-name: fadeInUp;
        }

        .animate-on-scroll.animated.fade-in {
            animation-name: fadeIn;
        }

        .animate-on-scroll.animated.scale-in {
            animation-name: scaleIn;
        }

        .animate-on-scroll.animated.slide-left {
            animation-name: slideInLeft;
        }

        .animate-on-scroll.animated.slide-right {
            animation-name: slideInRight;
        }

        /* 延迟类 */
        .delay-1 { animation-delay: 0.1s; }
        .delay-2 { animation-delay: 0.2s; }
        .delay-3 { animation-delay: 0.3s; }
        .delay-4 { animation-delay: 0.4s; }

        /* 卡片悬停效果增强 */
        .card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.12);
        }

        /* 按钮动效 */
        .btn {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .btn:active::after {
            width: 300px;
            height: 300px;
        }

        /* 干预卡片动效 */
        .intervention-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .intervention-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .intervention-card:hover .intervention-image i {
            animation: bounce 0.6s ease;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* 统计数字动效 */
        .stat-item {
            transition: transform 0.3s ease;
        }

        .stat-item:hover {
            transform: scale(1.05);
        }

        .stat-number {
            transition: transform 0.3s ease;
        }

        .stat-item:hover .stat-number {
            transform: scale(1.1);
        }

        /* 问卷选项动效 */
        .option-btn {
            transition: all 0.25s ease;
        }

        .option-btn:hover {
            transform: translateX(5px);
            border-color: var(--primary-green);
        }

        .option-btn.selected {
            animation: selectPulse 0.3s ease;
        }

        @keyframes selectPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        /* 页面切换动画 */
        .page {
            animation: fadeIn 0.4s ease;
        }

        /* 导航链接下划线动效 */
        .nav-menu a {
            position: relative;
        }

        .nav-menu a::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary-green);
            transition: width 0.3s ease;
        }

        .nav-menu a:hover::after,
        .nav-menu a.active::after {
            width: 100%;
        }

        /* Hero 文字动画 */
        .hero-content h1 {
            animation: fadeInUp 0.8s ease;
        }

        .hero-content p {
            animation: fadeInUp 0.8s ease 0.2s both;
        }

        .hero-content > div {
            animation: fadeInUp 0.8s ease 0.4s both;
        }

        /* 加载动画优化 */
        .loading {
            animation: fadeIn 0.3s ease;
        }

        /* 聊天消息动画 */
        .message {
            animation: fadeInUp 0.3s ease;
        }

        /* 步骤指示器动效 */
        .step-number {
            transition: all 0.3s ease;
        }

        .step.active .step-number {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(104, 159, 56, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(104, 159, 56, 0); }
        }

        /* 结果卡片动画 */
        .result-card {
            animation: scaleIn 0.5s ease;
        }

        /* 历史记录页面样式 */
        .history-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .history-stat-card {
            background: var(--bg-paper);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .history-stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 1.25rem;
        }

        .history-stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .history-stat-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        .history-empty {
            text-align: center;
            padding: 3rem 1rem;
        }

        .history-empty i {
            font-size: 4rem;
            color: var(--text-disabled);
            margin-bottom: 1rem;
        }

        .history-empty h3 {
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .history-empty p {
            color: var(--text-disabled);
            margin-bottom: 1.5rem;
        }

        /* 历史记录表格 */
        .history-table-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .history-table {
            width: 100%;
            min-width: 500px;
            border-collapse: collapse;
        }

        .history-table th,
        .history-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .history-table th {
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: rgba(104, 159, 56, 0.05);
        }

        .history-table tr:hover {
            background: rgba(104, 159, 56, 0.03);
        }

        .history-table td:nth-child(2) {
            font-weight: 600;
        }

        .history-item-level span {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .level-low {
            background: rgba(104, 159, 56, 0.15);
            color: var(--primary-green);
        }

        .level-medium {
            background: rgba(255, 238, 88, 0.3);
            color: #f9a825;
        }

        .level-high {
            background: rgba(244, 143, 177, 0.2);
            color: #e91e63;
        }

        .btn-delete {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
            background: rgba(244, 143, 177, 0.1);
            color: var(--flower-pink);
        }

        .btn-delete:hover {
            background: var(--flower-pink);
            color: white;
        }

        .trend-up { color: var(--flower-pink); }
        .trend-down { color: var(--primary-green); }
        .trend-stable { color: var(--sky-blue); }

        /* 清空历史按钮 */
        .btn-clear-history {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 8px 16px;
            font-size: 0.85rem;
            border: 2px solid var(--primary-green);
            background: transparent;
            color: var(--primary-green);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .btn-clear-history:hover {
            background: var(--primary-green);
            color: white;
        }

        @media (max-width: 768px) {
            .history-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .history-stat-card {
                padding: 1rem;
            }

            .history-stat-value {
                font-size: 1.4rem;
            }

            .chart-container {
                height: 250px;
            }

            /* 历史记录列表头部 */
            .history-list-header {
                flex-direction: column;
                align-items: stretch !important;
                gap: 1rem;
            }

            .history-list-header h3 {
                text-align: center;
            }

            .btn-clear-history {
                width: 100%;
                justify-content: center;
            }

            /* 历史记录表格 */
            .history-table th,
            .history-table td {
                padding: 0.75rem;
                font-size: 0.9rem;
                white-space: nowrap;
            }
        }

        /* 语言切换器 */
        .nav-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .lang-switcher {
            display: flex;
            background: rgba(104, 159, 56, 0.1);
            border-radius: 20px;
            padding: 4px;
        }

        .lang-btn {
            padding: 6px 12px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .lang-btn:hover {
            color: var(--primary-green);
        }

        .lang-btn.active {
            background: var(--primary-green);
            color: white;
        }

        @media (max-width: 768px) {
            .lang-switcher {
                margin-right: 0.5rem;
            }
            
            .lang-btn {
                padding: 5px 10px;
                font-size: 0.8rem;
            }

            .nav-right {
                gap: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="#" class="logo" onclick="showPage('home')">
                <i class="fas fa-leaf"></i>
                MindGarden
            </a>
            <ul class="nav-menu">
                <li><a href="#" onclick="showPage('home')" class="nav-link active" data-i18n="navHome">首页</a></li>
                <li><a href="#" onclick="showPage('assessment')" class="nav-link" data-i18n="navAssessment">压力评估</a></li>
                <li><a href="#" onclick="showPage('history')" class="nav-link" data-i18n="navHistory">历史记录</a></li>
                <li><a href="#" onclick="showPage('intervention')" class="nav-link" data-i18n="navIntervention">干预实验室</a></li>
                <li><a href="#" onclick="showPage('map')" class="nav-link" data-i18n="navMap">全球地图</a></li>
            </ul>
            <div class="nav-right">
                <div class="lang-switcher">
                    <button class="lang-btn active" data-lang="zh" onclick="switchLanguage('zh')">中文</button>
                    <button class="lang-btn" data-lang="en" onclick="switchLanguage('en')">EN</button>
                </div>
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- 主要内容 -->
    <main class="main-content">
        <!-- 首页 -->
        <div id="home" class="page active">
            <section class="hero">
                <div class="hero-content">
                    <h1 data-i18n="heroTitle">MindGarden</h1>
                    <p data-i18n="heroSubtitle">基于自然疗愈的学生压力干预AI平台</p>
                    <p data-i18n="heroDesc">将科研成果（NH+EE）应用于学生端，实现"实验室到教室"的转换，通过AI技术提供个性化的自然疗愈干预方案，帮助学生缓解压力，提升心理健康水平。</p>
                    <div style="margin-top: 2rem;">
                        <a href="#" class="btn btn-primary" onclick="showPage('assessment')" data-i18n="startAssessment">开始评估</a>
                        <a href="#" class="btn btn-outline" onclick="showPage('intervention')" style="margin-left: 1rem;" data-i18n="exploreIntervention">探索干预方案</a>
                    </div>
                </div>
            </section>

            <section class="section">
                <div class="container">
                    <h2 style="text-align: center; margin-bottom: 2rem; color: var(--text-primary);" data-i18n="featuresTitle">平台特色功能</h2>
                    <div class="grid grid-3">
                        <div class="card">
                            <div style="text-align: center; margin-bottom: 1rem;">
                                <i class="fas fa-clipboard-check" style="font-size: 3rem; color: var(--primary-green);"></i>
                            </div>
                            <h3 style="margin-bottom: 1rem;" data-i18n="feature1Title">科研驱动的压力评估</h3>
                            <p style="color: var(--text-secondary);" data-i18n="feature1Desc">基于自然疗愈(NH)和环境教育(EE)的科研成果，提供专业的压力评估工具，帮助学生了解自己的压力状态。</p>
                        </div>
                        <div class="card">
                            <div style="text-align: center; margin-bottom: 1rem;">
                                <i class="fas fa-flask" style="font-size: 3rem; color: var(--sky-blue);"></i>
                            </div>
                            <h3 style="margin-bottom: 1rem;" data-i18n="feature2Title">在线干预实验室</h3>
                            <p style="color: var(--text-secondary);" data-i18n="feature2Desc">提供个性化的自然疗愈干预方案，包括自然声音、引导式冥想、虚拟自然环境等多种干预方式。</p>
                        </div>
                        <div class="card">
                            <div style="text-align: center; margin-bottom: 1rem;">
                                <i class="fas fa-globe" style="font-size: 3rem; color: var(--sun-yellow);"></i>
                            </div>
                            <h3 style="margin-bottom: 1rem;" data-i18n="feature3Title">全球学生压力地图</h3>
                            <p style="color: var(--text-secondary);" data-i18n="feature3Desc">汇集全球学生压力数据，展示不同地区、不同学段学生的压力状况，为教育工作者提供决策参考。</p>
                        </div>
                    </div>
                </div>
            </section>

            <section class="section" style="background: var(--bg-default);">
                <div class="container">
                    <div class="grid grid-2" style="align-items: center;">
                        <div>
                            <h2 style="margin-bottom: 1rem; color: var(--text-primary);" data-i18n="researchTitle">科研驱动的干预推荐引擎</h2>
                            <p style="margin-bottom: 1rem; color: var(--text-secondary);" data-i18n="researchDesc1">MindGarden平台基于自然疗愈(NH)和环境教育(EE)的科研成果，结合DeepSeek大模型技术，构建了智能干预推荐引擎，为学生提供个性化的压力干预方案。</p>
                            <p style="color: var(--text-secondary);" data-i18n="researchDesc2">我们的研究表明，接触自然环境能显著降低学生的压力水平，提升注意力恢复和情绪调节能力。平台将这些科研发现转化为可实践的干预方案，帮助学生在日常学习生活中应用。</p>
                        </div>
                        <div class="card">
                            <h3 style="margin-bottom: 1rem; color: var(--primary-green);" data-i18n="researchDataTitle">科研数据支持</h3>
                            <div class="stats-grid">
                                <div class="stat-item" style="background: rgba(104, 159, 56, 0.1);">
                                    <div class="stat-number" style="color: var(--primary-green);">78%</div>
                                    <div class="stat-label" data-i18n="stressReduction">压力水平降低率</div>
                                </div>
                                <div class="stat-item" style="background: rgba(100, 181, 246, 0.1);">
                                    <div class="stat-number" style="color: var(--sky-blue);">65%</div>
                                    <div class="stat-label" data-i18n="attentionRecovery">注意力恢复提升</div>
                                </div>
                                <div class="stat-item" style="background: rgba(255, 238, 88, 0.1);">
                                    <div class="stat-number" style="color: var(--sun-yellow);">83%</div>
                                    <div class="stat-label" data-i18n="userSatisfaction">用户满意度</div>
                                </div>
                                <div class="stat-item" style="background: rgba(244, 143, 177, 0.1);">
                                    <div class="stat-number" style="color: var(--flower-pink);">71%</div>
                                    <div class="stat-label" data-i18n="emotionRegulation">情绪调节能力提升</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- 压力评估页面 -->
        <div id="assessment" class="page">
            <section class="hero">
                <div class="hero-content">
                    <h1 data-i18n="assessmentHeroTitle">AI压力评估</h1>
                    <p data-i18n="assessmentHeroSubtitle">基于自然疗愈理论的个性化压力评估与干预推荐</p>
                    <p data-i18n="assessmentHeroDesc">完成以下评估，我们将使用DeepSeek大模型分析您的压力状况，并提供个性化的自然疗愈干预建议</p>
                </div>
            </section>

            <section class="section">
                <div class="assessment-container">
                    <!-- 步骤指示器 -->
                    <div class="step-indicator">
                        <div class="step active" id="step1">
                            <div class="step-number">1</div>
                            <span data-i18n="step1">基本信息</span>
                        </div>
                        <div class="step" id="step2">
                            <div class="step-number">2</div>
                            <span data-i18n="step2">压力评估问卷</span>
                        </div>
                        <div class="step" id="step3">
                            <div class="step-number">3</div>
                            <span data-i18n="step3">分析结果</span>
                        </div>
                    </div>

                    <!-- 步骤1：基本信息 -->
                    <div id="assessment-step1" class="assessment-step">
                        <div class="card">
                            <h2 style="margin-bottom: 1rem;" data-i18n="basicInfoTitle">请填写您的基本信息</h2>
                            <div class="form-group">
                                <label for="name" data-i18n="labelName">姓名</label>
                                <input type="text" id="name" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="age" data-i18n="labelAge">年龄</label>
                                <input type="number" id="age" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="gender" data-i18n="labelGender">性别</label>
                                <select id="gender" class="form-control" required>
                                    <option value="" data-i18n="selectPlaceholder">请选择</option>
                                    <option value="男" data-i18n="male">男</option>
                                    <option value="女" data-i18n="female">女</option>
                                    <option value="其他" data-i18n="other">其他</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="occupation" data-i18n="labelOccupation">职业/学生类型</label>
                                <input type="text" id="occupation" class="form-control" data-i18n="occupationPlaceholder" placeholder="例如：高中生、大学生、研究生等" required>
                            </div>
                        </div>
                    </div>

                    <!-- 步骤2：问卷 -->
                    <div id="assessment-step2" class="assessment-step hidden">
                        <div class="card">
                            <h2 style="margin-bottom: 1rem;" data-i18n="questionnaireTitle">压力评估问卷</h2>
                            <p style="margin-bottom: 2rem; color: var(--text-secondary);" data-i18n="questionnaireDesc">请根据您的实际情况回答以下问题，这将帮助我们更准确地评估您的压力状况。</p>
                            
                            <div class="question">
                                <h3 data-i18n="q1">1. 在过去的一周中，您感到紧张或焦虑的频率如何？</h3>
                                <div class="options">
                                    <button class="option-btn" data-question="1" data-value="0" data-i18n="q1o1">从不</button>
                                    <button class="option-btn" data-question="1" data-value="1" data-i18n="q1o2">偶尔</button>
                                    <button class="option-btn" data-question="1" data-value="2" data-i18n="q1o3">有时</button>
                                    <button class="option-btn" data-question="1" data-value="3" data-i18n="q1o4">经常</button>
                                    <button class="option-btn" data-question="1" data-value="4" data-i18n="q1o5">总是</button>
                                </div>
                            </div>

                            <div class="question">
                                <h3 data-i18n="q2">2. 在面对学业压力时，您通常会如何应对？</h3>
                                <div class="options">
                                    <button class="option-btn" data-question="2" data-value="0" data-i18n="q2o1">积极寻求解决方案</button>
                                    <button class="option-btn" data-question="2" data-value="1" data-i18n="q2o2">寻求社交支持</button>
                                    <button class="option-btn" data-question="2" data-value="2" data-i18n="q2o3">尝试放松活动</button>
                                    <button class="option-btn" data-question="2" data-value="3" data-i18n="q2o4">回避或拖延</button>
                                    <button class="option-btn" data-question="2" data-value="4" data-i18n="q2o5">感到无助或沮丧</button>
                                </div>
                            </div>

                            <div class="question">
                                <h3 data-i18n="q3">3. 您的睡眠质量如何？</h3>
                                <div class="options">
                                    <button class="option-btn" data-question="3" data-value="0" data-i18n="q3o1">非常好</button>
                                    <button class="option-btn" data-question="3" data-value="1" data-i18n="q3o2">良好</button>
                                    <button class="option-btn" data-question="3" data-value="2" data-i18n="q3o3">一般</button>
                                    <button class="option-btn" data-question="3" data-value="3" data-i18n="q3o4">较差</button>
                                    <button class="option-btn" data-question="3" data-value="4" data-i18n="q3o5">非常差</button>
                                </div>
                            </div>

                            <div class="question">
                                <h3 data-i18n="q4">4. 您多久会感到身体疲劳或精力不足？</h3>
                                <div class="options">
                                    <button class="option-btn" data-question="4" data-value="0" data-i18n="q4o1">几乎不会</button>
                                    <button class="option-btn" data-question="4" data-value="1" data-i18n="q4o2">每月几次</button>
                                    <button class="option-btn" data-question="4" data-value="2" data-i18n="q4o3">每周几次</button>
                                    <button class="option-btn" data-question="4" data-value="3" data-i18n="q4o4">几乎每天</button>
                                    <button class="option-btn" data-question="4" data-value="4" data-i18n="q4o5">一天多次</button>
                                </div>
                            </div>

                            <div class="question">
                                <h3 data-i18n="q5">5. 您与自然环境接触的频率如何？</h3>
                                <div class="options">
                                    <button class="option-btn" data-question="5" data-value="0" data-i18n="q5o1">每天都有</button>
                                    <button class="option-btn" data-question="5" data-value="1" data-i18n="q5o2">每周几次</button>
                                    <button class="option-btn" data-question="5" data-value="2" data-i18n="q5o3">每月几次</button>
                                    <button class="option-btn" data-question="5" data-value="3" data-i18n="q5o4">很少</button>
                                    <button class="option-btn" data-question="5" data-value="4" data-i18n="q5o5">几乎没有</button>
                                </div>
                            </div>

                            <div class="form-group" style="margin-top: 2rem;">
                                <label for="description" data-i18n="descriptionLabel">请简要描述您最近感到压力的情况和可能的原因（至少50字）</label>
                                <textarea id="description" class="form-control" rows="4" data-i18n="descriptionPlaceholder" placeholder="例如：最近期末考试临近，我感到非常焦虑，经常失眠，注意力难以集中..." required></textarea>
                                <small id="char-count" style="color: var(--text-secondary);">0/50<span data-i18n="charCount">字</span></small>
                            </div>
                        </div>
                    </div>

                    <!-- 步骤3：结果 -->
                    <div id="assessment-step3" class="assessment-step hidden">
                        <div id="loading-result" class="loading">
                            <div class="spinner"></div>
                            <div style="margin-left: 1rem;" data-i18n="analyzing">正在分析您的压力状况...</div>
                        </div>
                        <div id="assessment-result" class="hidden">
                            <!-- 结果内容将通过JavaScript动态生成 -->
                        </div>
                    </div>

                    <!-- 导航按钮 -->
                    <div style="display: flex; justify-content: space-between; margin-top: 2rem;">
                        <button class="btn btn-outline" id="prev-btn" onclick="previousStep()" style="display: none;" data-i18n="prevBtn">上一步</button>
                        <button class="btn btn-primary" id="next-btn" onclick="nextStep()" data-i18n="nextBtn">下一步</button>
                    </div>
                </div>
            </section>
        </div>

        <!-- 干预实验室页面 -->
        <div id="intervention" class="page">
            <section class="hero">
                <div class="hero-content">
                    <h1 data-i18n="interventionHeroTitle">自然干预实验室</h1>
                    <p data-i18n="interventionHeroSubtitle">探索基于自然的压力干预方案，找到适合您的放松方式</p>
                    <p data-i18n="interventionHeroDesc">我们的干预实验室汇集了多种经科学验证的自然疗法，帮助您缓解压力、焦虑和抑郁。每种方法都基于严谨的研究，并提供了详细的实践指南。</p>
                </div>
            </section>

            <section class="section">
                <div class="container">
                    <h2 style="text-align: center; margin-bottom: 2rem; color: var(--text-primary);" data-i18n="interventionTitle">自然疗法干预方案</h2>
                    <div class="intervention-grid">
                        <div class="intervention-card">
                            <div class="intervention-image">
                                <i class="fas fa-tree"></i>
                            </div>
                            <div class="intervention-content">
                                <h3 data-i18n="forestBathing">森林浴疗法</h3>
                                <p data-i18n="forestBathingDesc">森林浴是一种通过在森林环境中漫步、呼吸和感受自然来减轻压力的方法。研究表明，森林浴可以降低皮质醇水平、减少焦虑，并改善整体心理健康。</p>
                                <ul class="benefits">
                                    <li data-i18n="forestBenefit1">降低皮质醇（压力激素）水平</li>
                                    <li data-i18n="forestBenefit2">减少焦虑和抑郁症状</li>
                                    <li data-i18n="forestBenefit3">增强免疫系统功能</li>
                                    <li data-i18n="forestBenefit4">改善注意力和认知能力</li>
                                    <li data-i18n="forestBenefit5">促进身心放松</li>
                                </ul>
                            </div>
                        </div>

                        <div class="intervention-card">
                            <div class="intervention-image">
                                <i class="fas fa-om"></i>
                            </div>
                            <div class="intervention-content">
                                <h3 data-i18n="mindfulness">正念冥想</h3>
                                <p data-i18n="mindfulnessDesc">正念冥想是一种通过专注于当下时刻、接受而不评判当前体验的心理训练方法。定期练习可以减轻压力、焦虑和抑郁症状，提高专注力和情绪调节能力。</p>
                                <ul class="benefits">
                                    <li data-i18n="mindfulnessBenefit1">减轻慢性压力和焦虑</li>
                                    <li data-i18n="mindfulnessBenefit2">提高专注力和注意力</li>
                                    <li data-i18n="mindfulnessBenefit3">增强情绪调节能力</li>
                                    <li data-i18n="mindfulnessBenefit4">改善睡眠质量</li>
                                    <li data-i18n="mindfulnessBenefit5">增强自我意识和同理心</li>
                                </ul>
                            </div>
                        </div>

                        <div class="intervention-card">
                            <div class="intervention-image">
                                <i class="fas fa-water"></i>
                            </div>
                            <div class="intervention-content">
                                <h3 data-i18n="hydrotherapy">水疗法</h3>
                                <p data-i18n="hydrotherapyDesc">水疗法利用水的物理特性（如温度、压力和浮力）来促进身心健康。从热水浴到冷水浸泡，不同形式的水疗可以减轻肌肉紧张、促进血液循环并诱导放松反应。</p>
                                <ul class="benefits">
                                    <li data-i18n="hydroBenefit1">缓解肌肉紧张和疼痛</li>
                                    <li data-i18n="hydroBenefit2">促进血液循环</li>
                                    <li data-i18n="hydroBenefit3">减轻关节压力</li>
                                    <li data-i18n="hydroBenefit4">促进深度放松</li>
                                    <li data-i18n="hydroBenefit5">改善皮肤健康</li>
                                </ul>
                            </div>
                        </div>

                        <div class="intervention-card">
                            <div class="intervention-image">
                                <i class="fas fa-spa"></i>
                            </div>
                            <div class="intervention-content">
                                <h3 data-i18n="aromatherapy">芳香疗法</h3>
                                <p data-i18n="aromatherapyDesc">芳香疗法使用植物精油的香气来改善身心健康。不同的精油具有不同的治疗特性，如薰衣草促进放松，柑橘提升情绪，迷迭香增强认知功能。</p>
                                <ul class="benefits">
                                    <li data-i18n="aromaBenefit1">减轻压力和焦虑</li>
                                    <li data-i18n="aromaBenefit2">改善睡眠质量</li>
                                    <li data-i18n="aromaBenefit3">缓解头痛和偏头痛</li>
                                    <li data-i18n="aromaBenefit4">提升情绪和精神状态</li>
                                    <li data-i18n="aromaBenefit5">支持免疫系统功能</li>
                                </ul>
                            </div>
                        </div>

                        <div class="intervention-card">
                            <div class="intervention-image">
                                <i class="fas fa-music"></i>
                            </div>
                            <div class="intervention-content">
                                <h3 data-i18n="musicTherapy">音乐疗法</h3>
                                <p data-i18n="musicTherapyDesc">音乐疗法利用音乐的元素（如节奏、旋律和和声）来改善身心健康。无论是主动参与音乐创作还是被动聆听，音乐都能影响大脑活动，调节情绪和生理反应。</p>
                                <ul class="benefits">
                                    <li data-i18n="musicBenefit1">降低压力激素水平</li>
                                    <li data-i18n="musicBenefit2">减轻焦虑和抑郁症状</li>
                                    <li data-i18n="musicBenefit3">改善情绪和心理状态</li>
                                    <li data-i18n="musicBenefit4">促进放松和睡眠</li>
                                    <li data-i18n="musicBenefit5">增强认知功能和记忆力</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="section" style="background: var(--bg-default);">
                <div class="container">
                    <h2 style="text-align: center; margin-bottom: 2rem; color: var(--text-primary);" data-i18n="scienceTitle">科学依据</h2>
                    <div class="card">
                        <h3 style="margin-bottom: 1rem; color: var(--primary-green);" data-i18n="scienceSubtitle">自然疗法的研究基础</h3>
                        <p style="margin-bottom: 1rem;" data-i18n="scienceP1">大量研究表明，与自然环境的接触对人类的身心健康有显著的积极影响。例如，2019年发表在《科学报告》上的一项研究发现，每周在自然环境中至少花费120分钟与健康和幸福感显著相关。</p>
                        <p style="margin-bottom: 1rem;" data-i18n="scienceP2">另一项发表在《国际环境研究与公共卫生杂志》上的研究表明，森林浴可以降低皮质醇水平、血压和心率，同时增强副交感神经系统活动，促进放松反应。</p>
                        <p style="margin-bottom: 1rem;" data-i18n="scienceP3">正念冥想的效果也得到了广泛研究。哈佛医学院的研究表明，正念冥想可以改变大脑结构，增加与学习、记忆、情绪调节和自我意识相关的脑区密度，同时减少与压力、焦虑和恐惧相关的脑区活动。</p>
                        <p data-i18n="scienceP4">我们的干预方案基于这些科学研究，旨在提供有效、可行的自然疗法，帮助您管理压力，提升心理健康。</p>
                    </div>
                </div>
            </section>

            <section class="section">
                <div class="container">
                    <h2 style="text-align: center; margin-bottom: 2rem; color: var(--text-primary);" data-i18n="journeyTitle">开始您的自然疗愈之旅</h2>
                    <div class="grid grid-2">
                        <div style="text-align: center;">
                            <h3 style="margin-bottom: 1rem;" data-i18n="unsureTitle">不确定哪种方法适合您？</h3>
                            <p style="margin-bottom: 1rem; color: var(--text-secondary);" data-i18n="unsureDesc">完成我们的压力评估，获取个性化的干预建议。</p>
                            <a href="#" class="btn btn-primary" onclick="showPage('assessment')" data-i18n="startAssessment">开始评估</a>
                        </div>
                        <div style="text-align: center;">
                            <h3 style="margin-bottom: 1rem;" data-i18n="globalTitle">想了解全球自然疗法实践情况？</h3>
                            <p style="margin-bottom: 1rem; color: var(--text-secondary);" data-i18n="globalDesc">探索我们的全球地图，查看世界各地的自然疗法实践和研究。</p>
                            <a href="#" class="btn btn-outline" onclick="showPage('map')" data-i18n="viewMap">查看全球地图</a>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- 历史记录页面 -->
        <div id="history" class="page">
            <section class="hero">
                <div class="hero-content">
                    <h1 data-i18n="historyHeroTitle">评估历史记录</h1>
                    <p data-i18n="historyHeroSubtitle">追踪您的压力变化趋势，见证成长与进步</p>
                </div>
            </section>

            <section class="section">
                <div class="container">
                    <!-- 统计概览 -->
                    <div class="history-stats" id="history-stats">
                        <!-- 由JS动态生成 -->
                    </div>

                    <!-- 趋势图表 -->
                    <div class="card" style="margin-bottom: 2rem;">
                        <h3 style="margin-bottom: 1.5rem; color: var(--primary-green);" data-i18n="historyTrendTitle">压力趋势图</h3>
                        <div class="chart-container" id="chart-container">
                            <canvas id="trend-chart"></canvas>
                        </div>
                    </div>

                    <!-- 历史记录列表 -->
                    <div class="card">
                        <div class="history-list-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; gap: 1rem; flex-wrap: wrap;">
                            <h3 style="color: var(--primary-green); margin: 0;" data-i18n="historyListTitle">历史评估记录</h3>
                            <button class="btn-clear-history" onclick="clearAllHistory()" id="clear-history-btn">
                                <i class="fas fa-trash-alt"></i> <span data-i18n="historyClearAll">清空所有记录</span>
                            </button>
                        </div>
                        <div id="history-list">
                            <!-- 由JS动态生成 -->
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- 全球地图页面 -->
        <div id="map" class="page">
            <section class="hero">
                <div class="hero-content"></div>
                    <h1 data-i18n="mapHeroTitle">全球学生压力地图</h1>
                    <p data-i18n="mapHeroSubtitle">探索全球学生压力状况和自然疗法实践情况</p>
                </div>
            </section>

            <section class="section">
                <div class="container">
                    <div class="card">
                        <h2 style="margin-bottom: 1rem; color: var(--text-primary);" data-i18n="mapOverviewTitle">全球压力数据概览</h2>
                        <p style="margin-bottom: 2rem; color: var(--text-secondary);" data-i18n="mapOverviewDesc">基于全球学生压力数据，我们可以看到不同地区、不同学段学生的压力状况分布。</p>
                        
                        <div class="grid grid-3">
                            <div style="text-align: center; padding: 1rem; background: rgba(104, 159, 56, 0.1); border-radius: 8px;">
                                <div style="font-size: 2rem; font-weight: 700; color: var(--primary-green);">15,000+</div>
                                <div style="color: var(--text-secondary);" data-i18n="participants">参与学生</div>
                            </div>
                            <div style="text-align: center; padding: 1rem; background: rgba(100, 181, 246, 0.1); border-radius: 8px;">
                                <div style="font-size: 2rem; font-weight: 700; color: var(--sky-blue);">45+</div>
                                <div style="color: var(--text-secondary);" data-i18n="countries">国家/地区</div>
                            </div>
                            <div style="text-align: center; padding: 1rem; background: rgba(255, 238, 88, 0.1); border-radius: 8px;">
                                <div style="font-size: 2rem; font-weight: 700; color: var(--sun-yellow);">85%</div>
                                <div style="color: var(--text-secondary);" data-i18n="improvementRate">改善率</div>
                            </div>
                        </div>

                        <div style="margin-top: 2rem; padding: 2rem; background: var(--bg-default); border-radius: 8px;">
                            <h3 style="margin-bottom: 1rem; color: var(--text-primary);" data-i18n="mapDevTitle">地图功能开发中</h3>
                            <p style="color: var(--text-secondary);" data-i18n="mapDevDesc">我们正在开发交互式全球地图功能，将展示：</p>
                            <ul style="margin-top: 1rem; color: var(--text-secondary);">
                                <li data-i18n="mapFeature1">各地区学生压力水平热力图</li>
                                <li data-i18n="mapFeature2">不同干预方式的效果对比</li>
                                <li data-i18n="mapFeature3">季节性压力变化趋势</li>
                                <li data-i18n="mapFeature4">文化背景对压力管理的影响</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="container">
            <p><strong data-i18n="footerTitle">MindGarden</strong> - <span data-i18n="footerSubtitle">基于自然疗愈的学生压力干预AI平台</span></p>
            <p data-i18n="footerCopyright">© 2024 MindGarden. 保留所有权利。</p>
        </div>
    </footer>

    <!-- 引入配置文件 -->
    <script src="config.js"></script>
    
    <script>
        // 多语言翻译数据
        const translations = {
            zh: {
                // 导航
                navHome: '首页',
                navAssessment: '压力评估',
                navHistory: '历史记录',
                navIntervention: '干预实验室',
                navMap: '全球地图',
                
                // 首页
                heroTitle: 'MindGarden',
                heroSubtitle: '基于自然疗愈的学生压力干预AI平台',
                heroDesc: '将科研成果（NH+EE）应用于学生端，实现"实验室到教室"的转换，通过AI技术提供个性化的自然疗愈干预方案，帮助学生缓解压力，提升心理健康水平。',
                startAssessment: '开始评估',
                exploreIntervention: '探索干预方案',
                
                // 特色功能
                featuresTitle: '平台特色功能',
                feature1Title: '科研驱动的压力评估',
                feature1Desc: '基于自然疗愈(NH)和环境教育(EE)的科研成果，提供专业的压力评估工具，帮助学生了解自己的压力状态。',
                feature2Title: '在线干预实验室',
                feature2Desc: '提供个性化的自然疗愈干预方案，包括自然声音、引导式冥想、虚拟自然环境等多种干预方式。',
                feature3Title: '全球学生压力地图',
                feature3Desc: '汇集全球学生压力数据，展示不同地区、不同学段学生的压力状况，为教育工作者提供决策参考。',
                
                // 科研数据
                researchTitle: '科研驱动的干预推荐引擎',
                researchDesc1: 'MindGarden平台基于自然疗愈(NH)和环境教育(EE)的科研成果，结合DeepSeek大模型技术，构建了智能干预推荐引擎，为学生提供个性化的压力干预方案。',
                researchDesc2: '我们的研究表明，接触自然环境能显著降低学生的压力水平，提升注意力恢复和情绪调节能力。平台将这些科研发现转化为可实践的干预方案，帮助学生在日常学习生活中应用。',
                researchDataTitle: '科研数据支持',
                stressReduction: '压力水平降低率',
                attentionRecovery: '注意力恢复提升',
                userSatisfaction: '用户满意度',
                emotionRegulation: '情绪调节能力提升',
                
                // 评估页面
                assessmentHeroTitle: 'AI压力评估',
                assessmentHeroSubtitle: '基于自然疗愈理论的个性化压力评估与干预推荐',
                assessmentHeroDesc: '完成以下评估，我们将使用DeepSeek大模型分析您的压力状况，并提供个性化的自然疗愈干预建议',
                step1: '基本信息',
                step2: '压力评估问卷',
                step3: '分析结果',
                basicInfoTitle: '请填写您的基本信息',
                labelName: '姓名',
                labelAge: '年龄',
                labelGender: '性别',
                labelOccupation: '职业/学生类型',
                selectPlaceholder: '请选择',
                male: '男',
                female: '女',
                other: '其他',
                occupationPlaceholder: '例如：高中生、大学生、研究生等',
                questionnaireTitle: '压力评估问卷',
                questionnaireDesc: '请根据您的实际情况回答以下问题，这将帮助我们更准确地评估您的压力状况。',
                q1: '1. 在过去的一周中，您感到紧张或焦虑的频率如何？',
                q1o1: '从不', q1o2: '偶尔', q1o3: '有时', q1o4: '经常', q1o5: '总是',
                q2: '2. 在面对学业压力时，您通常会如何应对？',
                q2o1: '积极寻求解决方案', q2o2: '寻求社交支持', q2o3: '尝试放松活动', q2o4: '回避或拖延', q2o5: '感到无助或沮丧',
                q3: '3. 您的睡眠质量如何？',
                q3o1: '非常好', q3o2: '良好', q3o3: '一般', q3o4: '较差', q3o5: '非常差',
                q4: '4. 您多久会感到身体疲劳或精力不足？',
                q4o1: '几乎不会', q4o2: '每月几次', q4o3: '每周几次', q4o4: '几乎每天', q4o5: '一天多次',
                q5: '5. 您与自然环境接触的频率如何？',
                q5o1: '每天都有', q5o2: '每周几次', q5o3: '每月几次', q5o4: '很少', q5o5: '几乎没有',
                descriptionLabel: '请简要描述您最近感到压力的情况和可能的原因（至少50字）',
                descriptionPlaceholder: '例如：最近期末考试临近，我感到非常焦虑，经常失眠，注意力难以集中...',
                charCount: '字',
                charCountHint: '(请至少输入50字)',
                prevBtn: '上一步',
                nextBtn: '下一步',
                submitBtn: '提交评估',
                analyzing: '正在分析您的压力状况...',
                fillAllInfo: '请填写所有基本信息',
                answerAllQuestions: '请回答所有问题',
                minCharsRequired: '请至少输入50字的描述',
                
                // 干预实验室
                interventionHeroTitle: '自然干预实验室',
                interventionHeroSubtitle: '探索基于自然的压力干预方案，找到适合您的放松方式',
                interventionHeroDesc: '我们的干预实验室汇集了多种经科学验证的自然疗法，帮助您缓解压力、焦虑和抑郁。每种方法都基于严谨的研究，并提供了详细的实践指南。',
                interventionTitle: '自然疗法干预方案',
                forestBathing: '森林浴疗法',
                forestBathingDesc: '森林浴是一种通过在森林环境中漫步、呼吸和感受自然来减轻压力的方法。研究表明，森林浴可以降低皮质醇水平、减少焦虑，并改善整体心理健康。',
                forestBenefit1: '降低皮质醇（压力激素）水平',
                forestBenefit2: '减少焦虑和抑郁症状',
                forestBenefit3: '增强免疫系统功能',
                forestBenefit4: '改善注意力和认知能力',
                forestBenefit5: '促进身心放松',
                mindfulness: '正念冥想',
                mindfulnessDesc: '正念冥想是一种通过专注于当下时刻、接受而不评判当前体验的心理训练方法。定期练习可以减轻压力、焦虑和抑郁症状，提高专注力和情绪调节能力。',
                mindfulnessBenefit1: '减轻慢性压力和焦虑',
                mindfulnessBenefit2: '提高专注力和注意力',
                mindfulnessBenefit3: '增强情绪调节能力',
                mindfulnessBenefit4: '改善睡眠质量',
                mindfulnessBenefit5: '增强自我意识和同理心',
                hydrotherapy: '水疗法',
                hydrotherapyDesc: '水疗法利用水的物理特性（如温度、压力和浮力）来促进身心健康。从热水浴到冷水浸泡，不同形式的水疗可以减轻肌肉紧张、促进血液循环并诱导放松反应。',
                hydroBenefit1: '缓解肌肉紧张和疼痛',
                hydroBenefit2: '促进血液循环',
                hydroBenefit3: '减轻关节压力',
                hydroBenefit4: '促进深度放松',
                hydroBenefit5: '改善皮肤健康',
                aromatherapy: '芳香疗法',
                aromatherapyDesc: '芳香疗法使用植物精油的香气来改善身心健康。不同的精油具有不同的治疗特性，如薰衣草促进放松，柑橘提升情绪，迷迭香增强认知功能。',
                aromaBenefit1: '减轻压力和焦虑',
                aromaBenefit2: '改善睡眠质量',
                aromaBenefit3: '缓解头痛和偏头痛',
                aromaBenefit4: '提升情绪和精神状态',
                aromaBenefit5: '支持免疫系统功能',
                musicTherapy: '音乐疗法',
                musicTherapyDesc: '音乐疗法利用音乐的元素（如节奏、旋律和和声）来改善身心健康。无论是主动参与音乐创作还是被动聆听，音乐都能影响大脑活动，调节情绪和生理反应。',
                musicBenefit1: '降低压力激素水平',
                musicBenefit2: '减轻焦虑和抑郁症状',
                musicBenefit3: '改善情绪和心理状态',
                musicBenefit4: '促进放松和睡眠',
                musicBenefit5: '增强认知功能和记忆力',
                scienceTitle: '科学依据',
                scienceSubtitle: '自然疗法的研究基础',
                scienceP1: '大量研究表明，与自然环境的接触对人类的身心健康有显著的积极影响。例如，2019年发表在《科学报告》上的一项研究发现，每周在自然环境中至少花费120分钟与健康和幸福感显著相关。',
                scienceP2: '另一项发表在《国际环境研究与公共卫生杂志》上的研究表明，森林浴可以降低皮质醇水平、血压和心率，同时增强副交感神经系统活动，促进放松反应。',
                scienceP3: '正念冥想的效果也得到了广泛研究。哈佛医学院的研究表明，正念冥想可以改变大脑结构，增加与学习、记忆、情绪调节和自我意识相关的脑区密度，同时减少与压力、焦虑和恐惧相关的脑区活动。',
                scienceP4: '我们的干预方案基于这些科学研究，旨在提供有效、可行的自然疗法，帮助您管理压力，提升心理健康。',
                journeyTitle: '开始您的自然疗愈之旅',
                unsureTitle: '不确定哪种方法适合您？',
                unsureDesc: '完成我们的压力评估，获取个性化的干预建议。',
                globalTitle: '想了解全球自然疗法实践情况？',
                globalDesc: '探索我们的全球地图，查看世界各地的自然疗法实践和研究。',
                viewMap: '查看全球地图',
                
                // 全球地图
                mapHeroTitle: '全球学生压力地图',
                mapHeroSubtitle: '探索全球学生压力状况和自然疗法实践情况',
                mapOverviewTitle: '全球压力数据概览',
                mapOverviewDesc: '基于全球学生压力数据，我们可以看到不同地区、不同学段学生的压力状况分布。',
                participants: '参与学生',
                countries: '国家/地区',
                improvementRate: '改善率',
                mapDevTitle: '地图功能开发中',
                mapDevDesc: '我们正在开发交互式全球地图功能，将展示：',
                mapFeature1: '各地区学生压力水平热力图',
                mapFeature2: '不同干预方式的效果对比',
                mapFeature3: '季节性压力变化趋势',
                mapFeature4: '文化背景对压力管理的影响',
                
                // 页脚
                footerTitle: 'MindGarden',
                footerSubtitle: '基于自然疗愈的学生压力干预AI平台',
                footerCopyright: '© 2024 MindGarden. 保留所有权利。',
                
                // 历史记录页面
                historyHeroTitle: '评估历史记录',
                historyHeroSubtitle: '追踪您的压力变化趋势，见证成长与进步',
                historyTrendTitle: '压力趋势图',
                historyListTitle: '历史评估记录',
                historyEmpty: '暂无评估记录',
                historyEmptyDesc: '完成一次压力评估后，您的记录将显示在这里。',
                historyStartAssessment: '开始首次评估',
                historyDate: '评估日期',
                historyScore: '压力得分',
                historyLevel: '压力等级',
                historyDetail: '查看详情',
                historyDelete: '删除',
                historyDeleteConfirm: '确定要删除这条记录吗？',
                historyClearAll: '清空所有记录',
                historyClearConfirm: '确定要清空所有历史记录吗？此操作不可恢复。',
                historyAvgScore: '平均得分',
                historyTotalAssessments: '评估次数',
                historyLatestLevel: '最近状态',
                historyTrend: '变化趋势',
                historyTrendUp: '上升',
                historyTrendDown: '下降',
                historyTrendStable: '稳定',
                
                // 结果页面
                stressLevel: '压力水平',
                stressScore: '压力得分',
                totalScore: '总分',
                analysisTitle: '压力状况分析',
                interventionAdvice: '个性化干预建议',
                dailyTip: '日常实践小贴士',
                exploreMore: '探索更多干预方案',
                chatTitle: '智能对话',
                chatPlaceholder: '输入你的消息...',
                send: '发送',
                thinking: '正在思考中...',
                lowStress: '低压力',
                mediumStress: '中等压力',
                highStress: '高压力',
                aiGreeting: '您好！根据您的评估结果，您的压力水平为：',
                aiGreetingEnd: '。如果您有任何疑问或需要进一步的帮助，请随时在下方对话框中提问。'
            },
            en: {
                // Navigation
                navHome: 'Home',
                navAssessment: 'Assessment',
                navHistory: 'History',
                navIntervention: 'Intervention Lab',
                navMap: 'Global Map',
                
                // Home
                heroTitle: 'MindGarden',
                heroSubtitle: 'AI Platform for Student Stress Intervention Based on Nature Healing',
                heroDesc: 'Applying research findings (NH+EE) to students, achieving the "lab to classroom" transformation. Through AI technology, we provide personalized nature healing intervention plans to help students relieve stress and improve mental health.',
                startAssessment: 'Start Assessment',
                exploreIntervention: 'Explore Interventions',
                
                // Features
                featuresTitle: 'Platform Features',
                feature1Title: 'Research-Driven Stress Assessment',
                feature1Desc: 'Based on research findings in Nature Healing (NH) and Environmental Education (EE), providing professional stress assessment tools to help students understand their stress levels.',
                feature2Title: 'Online Intervention Lab',
                feature2Desc: 'Providing personalized nature healing intervention plans, including natural sounds, guided meditation, virtual natural environments, and more.',
                feature3Title: 'Global Student Stress Map',
                feature3Desc: 'Aggregating global student stress data, showing stress conditions across different regions and education levels, providing decision-making references for educators.',
                
                // Research Data
                researchTitle: 'Research-Driven Intervention Recommendation Engine',
                researchDesc1: 'MindGarden platform is based on research findings in Nature Healing (NH) and Environmental Education (EE), combined with DeepSeek AI technology, building an intelligent intervention recommendation engine to provide personalized stress intervention plans for students.',
                researchDesc2: 'Our research shows that contact with natural environments can significantly reduce student stress levels, improve attention restoration and emotional regulation abilities. The platform transforms these research findings into practical intervention plans to help students apply them in daily learning and life.',
                researchDataTitle: 'Research Data Support',
                stressReduction: 'Stress Level Reduction',
                attentionRecovery: 'Attention Recovery Improvement',
                userSatisfaction: 'User Satisfaction',
                emotionRegulation: 'Emotion Regulation Improvement',
                
                // Assessment Page
                assessmentHeroTitle: 'AI Stress Assessment',
                assessmentHeroSubtitle: 'Personalized stress assessment and intervention recommendations based on nature healing theory',
                assessmentHeroDesc: 'Complete the following assessment, and we will use DeepSeek AI to analyze your stress condition and provide personalized nature healing intervention suggestions',
                step1: 'Basic Info',
                step2: 'Questionnaire',
                step3: 'Results',
                basicInfoTitle: 'Please fill in your basic information',
                labelName: 'Name',
                labelAge: 'Age',
                labelGender: 'Gender',
                labelOccupation: 'Occupation/Student Type',
                selectPlaceholder: 'Please select',
                male: 'Male',
                female: 'Female',
                other: 'Other',
                occupationPlaceholder: 'e.g., High school student, College student, Graduate student',
                questionnaireTitle: 'Stress Assessment Questionnaire',
                questionnaireDesc: 'Please answer the following questions based on your actual situation. This will help us more accurately assess your stress condition.',
                q1: '1. How often have you felt nervous or anxious in the past week?',
                q1o1: 'Never', q1o2: 'Rarely', q1o3: 'Sometimes', q1o4: 'Often', q1o5: 'Always',
                q2: '2. How do you usually cope with academic pressure?',
                q2o1: 'Actively seek solutions', q2o2: 'Seek social support', q2o3: 'Try relaxation activities', q2o4: 'Avoid or procrastinate', q2o5: 'Feel helpless or frustrated',
                q3: '3. How is your sleep quality?',
                q3o1: 'Very good', q3o2: 'Good', q3o3: 'Average', q3o4: 'Poor', q3o5: 'Very poor',
                q4: '4. How often do you feel physically tired or lack energy?',
                q4o1: 'Almost never', q4o2: 'A few times a month', q4o3: 'A few times a week', q4o4: 'Almost every day', q4o5: 'Multiple times a day',
                q5: '5. How often do you have contact with natural environments?',
                q5o1: 'Every day', q5o2: 'A few times a week', q5o3: 'A few times a month', q5o4: 'Rarely', q5o5: 'Almost never',
                descriptionLabel: 'Please briefly describe your recent stress situation and possible causes (at least 50 characters)',
                descriptionPlaceholder: 'e.g., With final exams approaching, I feel very anxious, often have insomnia, and find it hard to concentrate...',
                charCount: ' chars',
                charCountHint: '(Please enter at least 50 characters)',
                prevBtn: 'Previous',
                nextBtn: 'Next',
                submitBtn: 'Submit Assessment',
                analyzing: 'Analyzing your stress condition...',
                fillAllInfo: 'Please fill in all basic information',
                answerAllQuestions: 'Please answer all questions',
                minCharsRequired: 'Please enter at least 50 characters in the description',
                
                // Intervention Lab
                interventionHeroTitle: 'Nature Intervention Lab',
                interventionHeroSubtitle: 'Explore nature-based stress intervention plans and find the relaxation method that suits you',
                interventionHeroDesc: 'Our intervention lab brings together various scientifically validated natural therapies to help you relieve stress, anxiety, and depression. Each method is based on rigorous research and provides detailed practice guides.',
                interventionTitle: 'Natural Therapy Intervention Plans',
                forestBathing: 'Forest Bathing Therapy',
                forestBathingDesc: 'Forest bathing is a method of reducing stress by walking, breathing, and experiencing nature in a forest environment. Research shows that forest bathing can lower cortisol levels, reduce anxiety, and improve overall mental health.',
                forestBenefit1: 'Lower cortisol (stress hormone) levels',
                forestBenefit2: 'Reduce anxiety and depression symptoms',
                forestBenefit3: 'Enhance immune system function',
                forestBenefit4: 'Improve attention and cognitive ability',
                forestBenefit5: 'Promote physical and mental relaxation',
                mindfulness: 'Mindfulness Meditation',
                mindfulnessDesc: 'Mindfulness meditation is a psychological training method that focuses on the present moment and accepts current experiences without judgment. Regular practice can reduce stress, anxiety, and depression symptoms, and improve focus and emotional regulation.',
                mindfulnessBenefit1: 'Reduce chronic stress and anxiety',
                mindfulnessBenefit2: 'Improve focus and attention',
                mindfulnessBenefit3: 'Enhance emotional regulation',
                mindfulnessBenefit4: 'Improve sleep quality',
                mindfulnessBenefit5: 'Enhance self-awareness and empathy',
                hydrotherapy: 'Hydrotherapy',
                hydrotherapyDesc: 'Hydrotherapy uses the physical properties of water (such as temperature, pressure, and buoyancy) to promote physical and mental health. From hot baths to cold water immersion, different forms of hydrotherapy can relieve muscle tension, promote blood circulation, and induce relaxation.',
                hydroBenefit1: 'Relieve muscle tension and pain',
                hydroBenefit2: 'Promote blood circulation',
                hydroBenefit3: 'Reduce joint pressure',
                hydroBenefit4: 'Promote deep relaxation',
                hydroBenefit5: 'Improve skin health',
                aromatherapy: 'Aromatherapy',
                aromatherapyDesc: 'Aromatherapy uses the aroma of plant essential oils to improve physical and mental health. Different essential oils have different therapeutic properties, such as lavender for relaxation, citrus for mood enhancement, and rosemary for cognitive function.',
                aromaBenefit1: 'Reduce stress and anxiety',
                aromaBenefit2: 'Improve sleep quality',
                aromaBenefit3: 'Relieve headaches and migraines',
                aromaBenefit4: 'Enhance mood and mental state',
                aromaBenefit5: 'Support immune system function',
                musicTherapy: 'Music Therapy',
                musicTherapyDesc: 'Music therapy uses elements of music (such as rhythm, melody, and harmony) to improve physical and mental health. Whether actively participating in music creation or passively listening, music can affect brain activity and regulate emotions and physiological responses.',
                musicBenefit1: 'Lower stress hormone levels',
                musicBenefit2: 'Reduce anxiety and depression symptoms',
                musicBenefit3: 'Improve mood and mental state',
                musicBenefit4: 'Promote relaxation and sleep',
                musicBenefit5: 'Enhance cognitive function and memory',
                scienceTitle: 'Scientific Evidence',
                scienceSubtitle: 'Research Foundation of Natural Therapy',
                scienceP1: 'Extensive research shows that contact with natural environments has significant positive effects on human physical and mental health. For example, a 2019 study published in Scientific Reports found that spending at least 120 minutes per week in natural environments is significantly associated with health and well-being.',
                scienceP2: 'Another study published in the International Journal of Environmental Research and Public Health shows that forest bathing can lower cortisol levels, blood pressure, and heart rate, while enhancing parasympathetic nervous system activity and promoting relaxation.',
                scienceP3: 'The effects of mindfulness meditation have also been extensively studied. Research from Harvard Medical School shows that mindfulness meditation can change brain structure, increasing density in brain regions related to learning, memory, emotional regulation, and self-awareness, while reducing activity in brain regions related to stress, anxiety, and fear.',
                scienceP4: 'Our intervention plans are based on these scientific studies, aiming to provide effective and feasible natural therapies to help you manage stress and improve mental health.',
                journeyTitle: 'Start Your Nature Healing Journey',
                unsureTitle: 'Not sure which method suits you?',
                unsureDesc: 'Complete our stress assessment to get personalized intervention recommendations.',
                globalTitle: 'Want to learn about global natural therapy practices?',
                globalDesc: 'Explore our global map to see natural therapy practices and research around the world.',
                viewMap: 'View Global Map',
                
                // Global Map
                mapHeroTitle: 'Global Student Stress Map',
                mapHeroSubtitle: 'Explore global student stress conditions and natural therapy practices',
                mapOverviewTitle: 'Global Stress Data Overview',
                mapOverviewDesc: 'Based on global student stress data, we can see the distribution of stress conditions among students in different regions and education levels.',
                participants: 'Participants',
                countries: 'Countries/Regions',
                improvementRate: 'Improvement Rate',
                mapDevTitle: 'Map Feature Under Development',
                mapDevDesc: 'We are developing an interactive global map feature that will display:',
                mapFeature1: 'Regional student stress level heat map',
                mapFeature2: 'Comparison of different intervention effects',
                mapFeature3: 'Seasonal stress change trends',
                mapFeature4: 'Impact of cultural background on stress management',
                
                // Footer
                footerTitle: 'MindGarden',
                footerSubtitle: 'AI Platform for Student Stress Intervention Based on Nature Healing',
                footerCopyright: '© 2024 MindGarden. All rights reserved.',
                
                // History Page
                historyHeroTitle: 'Assessment History',
                historyHeroSubtitle: 'Track your stress trends and witness your growth',
                historyTrendTitle: 'Stress Trend Chart',
                historyListTitle: 'Assessment Records',
                historyEmpty: 'No Records Yet',
                historyEmptyDesc: 'Your assessment records will appear here after completing an assessment.',
                historyStartAssessment: 'Start First Assessment',
                historyDate: 'Date',
                historyScore: 'Score',
                historyLevel: 'Level',
                historyDetail: 'Details',
                historyDelete: 'Delete',
                historyDeleteConfirm: 'Are you sure you want to delete this record?',
                historyClearAll: 'Clear All Records',
                historyClearConfirm: 'Are you sure you want to clear all history? This cannot be undone.',
                historyAvgScore: 'Average Score',
                historyTotalAssessments: 'Total Assessments',
                historyLatestLevel: 'Latest Status',
                historyTrend: 'Trend',
                historyTrendUp: 'Rising',
                historyTrendDown: 'Falling',
                historyTrendStable: 'Stable',
                
                // Results Page
                stressLevel: 'Stress Level',
                stressScore: 'Stress Score',
                totalScore: 'Total Score',
                analysisTitle: 'Stress Analysis',
                interventionAdvice: 'Personalized Intervention Recommendations',
                dailyTip: 'Daily Practice Tips',
                exploreMore: 'Explore More Interventions',
                chatTitle: 'AI Chat',
                chatPlaceholder: 'Enter your message...',
                send: 'Send',
                thinking: 'Thinking...',
                lowStress: 'Low Stress',
                mediumStress: 'Medium Stress',
                highStress: 'High Stress',
                aiGreeting: 'Hello! Based on your assessment results, your stress level is: ',
                aiGreetingEnd: '. If you have any questions or need further help, please feel free to ask in the chat box below.'
            }
        };

        // 当前语言
        let currentLang = 'zh';

        // 语言切换函数
        function switchLanguage(lang) {
            currentLang = lang;
            
            // 更新按钮状态
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
            
            // 更新HTML lang属性
            document.documentElement.lang = lang === 'zh' ? 'zh-CN' : 'en';
            
            // 更新页面文本
            updatePageText();
            
            // 如果结果页面已显示，重新渲染
            if (lastAssessmentResult) {
                renderAssessmentResult(lastAssessmentResult);
            }
            
            // 保存语言偏好
            localStorage.setItem('mindgarden-lang', lang);
        }

        // 更新页面文本
        function updatePageText() {
            const t = translations[currentLang];
            
            // 更新导航
            const navLinks = document.querySelectorAll('.nav-link');
            if (navLinks[0]) navLinks[0].textContent = t.navHome;
            if (navLinks[1]) navLinks[1].textContent = t.navAssessment;
            if (navLinks[2]) navLinks[2].textContent = t.navIntervention;
            if (navLinks[3]) navLinks[3].textContent = t.navMap;
            
            // 更新所有带 data-i18n 属性的元素
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.dataset.i18n;
                if (t[key]) {
                    if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                        el.placeholder = t[key];
                    } else {
                        el.textContent = t[key];
                    }
                }
            });
            
            // 更新页面标题
            document.title = currentLang === 'zh' 
                ? 'MindGarden - 基于自然疗愈的学生压力干预AI平台'
                : 'MindGarden - AI Platform for Student Stress Intervention';
        }

        // 获取翻译文本
        function getText(key) {
            return translations[currentLang][key] || key;
        }

        // 全局变量
        let currentStep = 1;
        let userAnswers = {};
        let assessmentData = {};
        let chatMessages = [];
        let lastAssessmentResult = null; // 保存最后一次评估结果用于语言切换
        let trendChart = null; // 图表实例

        // 页面导航
        function showPage(pageId) {
            // 隐藏所有页面
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // 显示目标页面
            document.getElementById(pageId).classList.add('active');
            
            // 更新导航链接状态
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            if (event && event.target) {
                event.target.classList.add('active');
            }

            // 如果是历史记录页面，渲染内容
            if (pageId === 'history') {
                renderHistoryPage();
            }

            // 滚动到顶部
            window.scrollTo(0, 0);
        }

        // 移动端菜单切换
        function toggleMobileMenu() {
            const navMenu = document.querySelector('.nav-menu');
            const menuBtn = document.querySelector('.mobile-menu-btn i');
            navMenu.classList.toggle('active');
            
            // 切换图标
            if (navMenu.classList.contains('active')) {
                menuBtn.classList.remove('fa-bars');
                menuBtn.classList.add('fa-times');
            } else {
                menuBtn.classList.remove('fa-times');
                menuBtn.classList.add('fa-bars');
            }
        }

        // 点击菜单项后关闭移动端菜单
        document.querySelectorAll('.nav-menu a').forEach(link => {
            link.addEventListener('click', () => {
                const navMenu = document.querySelector('.nav-menu');
                const menuBtn = document.querySelector('.mobile-menu-btn i');
                if (navMenu.classList.contains('active')) {
                    navMenu.classList.remove('active');
                    menuBtn.classList.remove('fa-times');
                    menuBtn.classList.add('fa-bars');
                }
            });
        });

        // 点击页面其他区域关闭菜单
        document.addEventListener('click', (e) => {
            const navMenu = document.querySelector('.nav-menu');
            const menuBtn = document.querySelector('.mobile-menu-btn');
            if (navMenu.classList.contains('active') && 
                !navMenu.contains(e.target) && 
                !menuBtn.contains(e.target)) {
                navMenu.classList.remove('active');
                const icon = menuBtn.querySelector('i');
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
            }
        });

        // 评估步骤导航
        function nextStep() {
            if (currentStep === 1) {
                // 验证基本信息
                const name = document.getElementById('name').value.trim();
                const age = document.getElementById('age').value.trim();
                const gender = document.getElementById('gender').value;
                const occupation = document.getElementById('occupation').value.trim();
                
                if (!name || !age || !gender || !occupation) {
                    alert(getText('fillAllInfo'));
                    return;
                }
                
                assessmentData = { name, age, gender, occupation };
                showAssessmentStep(2);
            } else if (currentStep === 2) {
                // 验证问卷答案
                if (Object.keys(userAnswers).length < 5) {
                    alert(getText('answerAllQuestions'));
                    return;
                }
                
                const description = document.getElementById('description').value.trim();
                if (description.length < 50) {
                    alert(getText('minCharsRequired'));
                    return;
                }
                
                assessmentData.description = description;
                showAssessmentStep(3);
                submitAssessment();
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                showAssessmentStep(currentStep - 1);
            }
        }

        function showAssessmentStep(step) {
            currentStep = step;
            
            // 更新步骤指示器
            document.querySelectorAll('.step').forEach((stepEl, index) => {
                stepEl.classList.remove('active', 'completed');
                if (index + 1 < step) {
                    stepEl.classList.add('completed');
                } else if (index + 1 === step) {
                    stepEl.classList.add('active');
                }
            });
            
            // 显示对应步骤内容
            document.querySelectorAll('.assessment-step').forEach(stepEl => {
                stepEl.classList.add('hidden');
            });
            document.getElementById(`assessment-step${step}`).classList.remove('hidden');
            
            // 更新按钮状态
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            
            prevBtn.style.display = step > 1 ? 'block' : 'none';
            
            if (step === 3) {
                nextBtn.style.display = 'none';
            } else {
                nextBtn.style.display = 'block';
                nextBtn.textContent = step === 2 ? getText('submitBtn') : getText('nextBtn');
            }
        }

        // 问卷选项选择
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('option-btn')) {
                const questionId = parseInt(e.target.dataset.question);
                const value = parseInt(e.target.dataset.value);
                
                // 移除同问题的其他选中状态
                document.querySelectorAll(`[data-question="${questionId}"]`).forEach(btn => {
                    btn.classList.remove('selected');
                });
                
                // 添加选中状态
                e.target.classList.add('selected');
                
                // 保存答案
                userAnswers[questionId] = value;
            }
        });

        // 字符计数
        document.getElementById('description').addEventListener('input', function(e) {
            const count = e.target.value.length;
            const charCountText = getText('charCount');
            const hintText = count < 50 ? ' ' + getText('charCountHint') : '';
            document.getElementById('char-count').textContent = `${count}/50${charCountText}${hintText}`;
        });

        // 提交评估
        async function submitAssessment() {
            const loadingEl = document.getElementById('loading-result');
            const resultEl = document.getElementById('assessment-result');
            
            loadingEl.classList.remove('hidden');
            resultEl.classList.add('hidden');
            
            try {
                // 计算压力分数
                const totalScore = Object.values(userAnswers).reduce((sum, score) => sum + score, 0);
                const maxScore = CONFIG.MAX_SCORE;
                const percentage = (totalScore / maxScore) * 100;
                
                let stressLevelKey;
                if (percentage < CONFIG.LOW_STRESS_THRESHOLD) {
                    stressLevelKey = 'lowStress';
                } else if (percentage < CONFIG.MEDIUM_STRESS_THRESHOLD) {
                    stressLevelKey = 'mediumStress';
                } else {
                    stressLevelKey = 'highStress';
                }
                
                // 保存结果数据用于语言切换时重新渲染
                lastAssessmentResult = {
                    totalScore,
                    maxScore,
                    stressLevelKey
                };
                
                // 显示结果
                setTimeout(() => {
                    loadingEl.classList.add('hidden');
                    resultEl.classList.remove('hidden');
                    renderAssessmentResult(lastAssessmentResult);
                }, 2000);
                
            } catch (error) {
                console.error('评估提交失败:', error);
                loadingEl.innerHTML = `<div style="color: var(--flower-pink);">${currentLang === 'zh' ? '评估提交失败，请稍后重试' : 'Assessment submission failed, please try again later'}</div>`;
            }
        }

        // 渲染评估结果（支持语言切换时重新渲染）
        async function renderAssessmentResult(result) {
            const resultEl = document.getElementById('assessment-result');
            const { totalScore, maxScore, stressLevelKey } = result;
            
            const stressLevel = getText(stressLevelKey);
            let stressIcon, stressColor;
            
            if (stressLevelKey === 'lowStress') {
                stressIcon = '😊';
                stressColor = 'var(--primary-green)';
            } else if (stressLevelKey === 'mediumStress') {
                stressIcon = '😐';
                stressColor = 'var(--sun-yellow)';
            } else {
                stressIcon = '😰';
                stressColor = 'var(--flower-pink)';
            }
            
            // 获取AI分析或本地分析
            let aiResponse;
            try {
                aiResponse = await callDeepSeekAPI(assessmentData, userAnswers, stressLevel, totalScore);
            } catch (apiError) {
                console.warn('API调用失败，使用备用分析:', apiError);
                aiResponse = {
                    analysis: generateAnalysis(assessmentData, stressLevelKey, totalScore),
                    interventions: generateInterventions(stressLevelKey),
                    tip: generateTip(stressLevelKey)
                };
            }
            
            const userLabel = currentLang === 'zh' ? '您' : 'You';
            const aiLabel = currentLang === 'zh' ? 'AI助手' : 'AI Assistant';
            const scoreUnit = currentLang === 'zh' ? '分' : '';
            
            resultEl.innerHTML = `
                <div class="result-card">
                    <div class="stress-level" style="color: ${stressColor};">
                        ${stressIcon} ${getText('stressLevel')}: ${stressLevel}
                    </div>
                    <p>${getText('stressScore')}: ${totalScore}${scoreUnit} (${getText('totalScore')} ${maxScore}${scoreUnit})</p>
                </div>
                
                <div class="card" style="margin-bottom: 1rem;">
                    <h3 style="margin-bottom: 1rem; color: var(--primary-green);">${getText('analysisTitle')}</h3>
                    <p>${aiResponse.analysis}</p>
                </div>
                
                <div class="card" style="margin-bottom: 1rem;">
                    <h3 style="margin-bottom: 1rem; color: var(--primary-green);">${getText('interventionAdvice')}</h3>
                    ${aiResponse.interventions.map(intervention => `
                        <div class="intervention-card">
                            <h4 style="margin-bottom: 0.5rem;">${intervention.method}</h4>
                            <p style="margin-bottom: 0.5rem; color: var(--text-secondary);">${intervention.effect}</p>
                            <small style="color: var(--text-secondary);">${intervention.reason}</small>
                        </div>
                    `).join('')}
                </div>
                
                <div class="card" style="background: rgba(104, 159, 56, 0.1);">
                    <h3 style="margin-bottom: 1rem; color: var(--primary-green);">
                        <i class="fas fa-lightbulb"></i> ${getText('dailyTip')}
                    </h3>
                    <p>${aiResponse.tip}</p>
                </div>
                
                <div style="text-align: center; margin-top: 2rem;">
                    <a href="#" class="btn btn-primary" onclick="showPage('intervention')">${getText('exploreMore')}</a>
                </div>
                
                <div style="margin-top: 2rem;">
                    <h3 style="margin-bottom: 1rem; color: var(--primary-green);">${getText('chatTitle')}</h3>
                    <div class="chat-container">
                        <div class="chat-messages" id="chat-messages">
                            <div class="message bot">
                                <strong>${aiLabel}：</strong>${getText('aiGreeting')}${stressLevel}${getText('aiGreetingEnd')}
                            </div>
                        </div>
                        <div class="chat-input">
                            <input type="text" id="chat-input" placeholder="${getText('chatPlaceholder')}">
                            <button class="btn btn-primary" onclick="sendMessage()">${getText('send')}</button>
                        </div>
                    </div>
                </div>
            `;
            
            // 初始化聊天消息数组
            chatMessages = [
                { role: 'assistant', content: `${getText('aiGreeting')}${stressLevel}${getText('aiGreetingEnd')}` }
            ];

            // 保存评估结果到历史记录（仅在首次渲染时保存，语言切换时不重复保存）
            if (!result.saved) {
                saveAssessmentToHistory(result);
                result.saved = true;
            }
        }

        // 保存评估结果到历史记录
        function saveAssessmentToHistory(result) {
            const history = getAssessmentHistory();
            const record = {
                id: Date.now(),
                date: new Date().toISOString(),
                score: result.totalScore,
                maxScore: result.maxScore,
                stressLevelKey: result.stressLevelKey,
                name: assessmentData.name || '',
                answers: { ...userAnswers }
            };
            history.unshift(record);
            // 最多保存50条记录
            if (history.length > 50) {
                history.pop();
            }
            localStorage.setItem('mindgarden-history', JSON.stringify(history));
        }

        // 获取历史记录
        function getAssessmentHistory() {
            try {
                const history = localStorage.getItem('mindgarden-history');
                return history ? JSON.parse(history) : [];
            } catch (e) {
                return [];
            }
        }

        // 渲染历史记录页面
        function renderHistoryPage() {
            const history = getAssessmentHistory();
            renderHistoryStats(history);
            renderHistoryChart(history);
            renderHistoryList(history);
        }

        // 渲染统计概览
        function renderHistoryStats(history) {
            const statsEl = document.getElementById('history-stats');
            
            if (history.length === 0) {
                statsEl.innerHTML = '';
                return;
            }

            const avgScore = Math.round(history.reduce((sum, r) => sum + r.score, 0) / history.length);
            const latestLevel = getText(history[0].stressLevelKey);
            
            // 计算趋势
            let trend = 'stable';
            let trendIcon = 'fa-minus';
            let trendClass = 'trend-stable';
            if (history.length >= 2) {
                const recent = history.slice(0, Math.min(3, history.length));
                const older = history.slice(Math.min(3, history.length), Math.min(6, history.length));
                if (older.length > 0) {
                    const recentAvg = recent.reduce((s, r) => s + r.score, 0) / recent.length;
                    const olderAvg = older.reduce((s, r) => s + r.score, 0) / older.length;
                    if (recentAvg > olderAvg + 1) {
                        trend = 'up';
                        trendIcon = 'fa-arrow-up';
                        trendClass = 'trend-up';
                    } else if (recentAvg < olderAvg - 1) {
                        trend = 'down';
                        trendIcon = 'fa-arrow-down';
                        trendClass = 'trend-down';
                    }
                }
            }

            statsEl.innerHTML = `
                <div class="history-stat-card animate-on-scroll fade-up">
                    <div class="history-stat-icon" style="background: rgba(104, 159, 56, 0.15);">
                        <i class="fas fa-chart-line" style="color: var(--primary-green);"></i>
                    </div>
                    <div class="history-stat-value" style="color: var(--primary-green);">${avgScore}</div>
                    <div class="history-stat-label" data-i18n="historyAvgScore">${getText('historyAvgScore')}</div>
                </div>
                <div class="history-stat-card animate-on-scroll fade-up delay-1">
                    <div class="history-stat-icon" style="background: rgba(100, 181, 246, 0.15);">
                        <i class="fas fa-clipboard-list" style="color: var(--sky-blue);"></i>
                    </div>
                    <div class="history-stat-value" style="color: var(--sky-blue);">${history.length}</div>
                    <div class="history-stat-label" data-i18n="historyTotalAssessments">${getText('historyTotalAssessments')}</div>
                </div>
                <div class="history-stat-card animate-on-scroll fade-up delay-2">
                    <div class="history-stat-icon" style="background: rgba(255, 238, 88, 0.2);">
                        <i class="fas fa-heart" style="color: var(--sun-yellow);"></i>
                    </div>
                    <div class="history-stat-value" style="color: var(--sun-yellow);">${latestLevel}</div>
                    <div class="history-stat-label" data-i18n="historyLatestLevel">${getText('historyLatestLevel')}</div>
                </div>
                <div class="history-stat-card animate-on-scroll fade-up delay-3">
                    <div class="history-stat-icon" style="background: rgba(244, 143, 177, 0.15);">
                        <i class="fas ${trendIcon}" style="color: var(--flower-pink);"></i>
                    </div>
                    <div class="history-stat-value ${trendClass}">
                        <i class="fas ${trendIcon}"></i> ${getText('historyTrend' + trend.charAt(0).toUpperCase() + trend.slice(1))}
                    </div>
                    <div class="history-stat-label" data-i18n="historyTrend">${getText('historyTrend')}</div>
                </div>
            `;

            // 触发动画
            setTimeout(() => {
                statsEl.querySelectorAll('.animate-on-scroll').forEach(el => el.classList.add('animated'));
            }, 100);
        }

        // 渲染趋势图表
        function renderHistoryChart(history) {
            const container = document.getElementById('chart-container');
            
            if (history.length === 0) {
                container.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-disabled);">
                        <i class="fas fa-chart-area" style="font-size: 3rem;"></i>
                    </div>
                `;
                return;
            }

            // 确保canvas存在
            if (!document.getElementById('trend-chart')) {
                container.innerHTML = '<canvas id="trend-chart"></canvas>';
            }

            const ctx = document.getElementById('trend-chart').getContext('2d');
            
            // 销毁旧图表
            if (trendChart) {
                trendChart.destroy();
            }

            // 准备数据（最近10条，按时间正序）
            const recentHistory = history.slice(0, 10).reverse();
            const labels = recentHistory.map(r => {
                const date = new Date(r.date);
                return `${date.getMonth() + 1}/${date.getDate()}`;
            });
            const scores = recentHistory.map(r => r.score);

            trendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: getText('stressScore'),
                        data: scores,
                        borderColor: '#689F38',
                        backgroundColor: 'rgba(104, 159, 56, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#689F38',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 5,
                        pointHoverRadius: 7
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(46, 59, 46, 0.9)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            padding: 12,
                            cornerRadius: 8
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 20,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                color: '#5C6D63'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#5C6D63'
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
        }

        // 渲染历史记录列表
        function renderHistoryList(history) {
            const listEl = document.getElementById('history-list');
            const clearBtn = document.getElementById('clear-history-btn');
            
            if (history.length === 0) {
                clearBtn.style.display = 'none';
                listEl.innerHTML = `
                    <div class="history-empty">
                        <i class="fas fa-inbox"></i>
                        <h3 data-i18n="historyEmpty">${getText('historyEmpty')}</h3>
                        <p data-i18n="historyEmptyDesc">${getText('historyEmptyDesc')}</p>
                        <a href="#" class="btn btn-primary" onclick="showPage('assessment')" data-i18n="historyStartAssessment">${getText('historyStartAssessment')}</a>
                    </div>
                `;
                return;
            }

            clearBtn.style.display = 'inline-flex';
            
            const tableRows = history.map(record => {
                const date = new Date(record.date);
                const dateStr = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
                const levelText = getText(record.stressLevelKey);
                let levelClass = 'level-medium';
                if (record.stressLevelKey === 'lowStress') levelClass = 'level-low';
                else if (record.stressLevelKey === 'highStress') levelClass = 'level-high';

                return `
                    <tr data-id="${record.id}">
                        <td>
                            <i class="fas fa-calendar-alt" style="color: var(--text-disabled); margin-right: 0.5rem;"></i>
                            ${dateStr}
                        </td>
                        <td>${record.score}/${record.maxScore}</td>
                        <td><span class="history-item-level"><span class="${levelClass}">${levelText}</span></span></td>
                        <td>
                            <button class="btn-delete" onclick="deleteHistoryRecord(${record.id})">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');

            listEl.innerHTML = `
                <div class="history-table-wrapper">
                    <table class="history-table">
                        <thead>
                            <tr>
                                <th data-i18n="historyDate">${getText('historyDate')}</th>
                                <th data-i18n="historyScore">${getText('historyScore')}</th>
                                <th data-i18n="historyLevel">${getText('historyLevel')}</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            ${tableRows}
                        </tbody>
                    </table>
                </div>
            `;
        }

        // 删除单条记录
        function deleteHistoryRecord(id) {
            if (!confirm(getText('historyDeleteConfirm'))) return;
            
            let history = getAssessmentHistory();
            history = history.filter(r => r.id !== id);
            localStorage.setItem('mindgarden-history', JSON.stringify(history));
            renderHistoryPage();
        }

        // 清空所有记录
        function clearAllHistory() {
            if (!confirm(getText('historyClearConfirm'))) return;
            
            localStorage.removeItem('mindgarden-history');
            renderHistoryPage();
        }

        // 调用DeepSeek API
        async function callDeepSeekAPI(userData, answers, stressLevel, score) {
            if (!CONFIG.DEEPSEEK_API_KEY || CONFIG.DEEPSEEK_API_KEY === 'sk-b6c7c8c460e14cc0bf2dc5de2bc3e0bc') {
                throw new Error('请配置有效的DeepSeek API密钥');
            }

            const prompt = `
作为一位专业的自然疗法心理咨询师，精通自然疗法、森田疗法、音乐疗法和中医等领域，请您根据以下学生的详细信息和评估结果，提供一份既温暖贴心又专业实用的压力状况分析和个性化干预建议。请确保您的回复能够体现出对学生情绪的理解与支持，并结合自然疗法、森田疗法、音乐疗法和中医等领域的知识，给出具体、可操作的建议。

基本信息：
- 姓名：${userData.name}
- 年龄：${userData.age}
- 性别：${userData.gender}
- 职业：${userData.occupation}

压力评估问卷结果：
- 压力得分：${score}分（总分${CONFIG.MAX_SCORE}分）
- 压力水平：${stressLevel}

学生的自我描述：
"${userData.description}"

请您：
1. 提供一份深入且富有同情心的压力状况分析（200字以内），请在分析中融入对学生感受的理解和肯定。
2. 给出三条最适合该学生的、科学且具体的自然疗愈干预建议，每条建议需包含详细的方法步骤、预期效果以及为何适合该学生的简要说明。
3. 提供一条易于融入日常生活的、积极向上的实践小贴士，帮助学生逐步改善。

回复格式应为JSON，包含以下字段：
{"analysis": "压力状况分析", "interventions": [{"method": "方法1", "effect": "预期效果1", "reason": "适合理由1"}, {"method": "方法2", "effect": "预期效果2", "reason": "适合理由2"}, {"method": "方法3", "effect": "预期效果3", "reason": "适合理由3"}], "tip": "日常实践小贴士"}
            `;

            const response = await fetch(CONFIG.DEEPSEEK_API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${CONFIG.DEEPSEEK_API_KEY}`
                },
                body: JSON.stringify({
                    model: 'deepseek-chat',
                    messages: [{ role: 'user', content: prompt }],
                    temperature: 0.7,
                    max_tokens: 800
                })
            });

            if (!response.ok) {
                throw new Error(`API请求失败: ${response.status}`);
            }

            const data = await response.json();
            let aiResponse;
            
            try {
                aiResponse = JSON.parse(data.choices[0].message.content);
            } catch (parseError) {
                console.error('解析API响应失败:', parseError);
                // 如果解析失败，使用备用响应
                aiResponse = {
                    analysis: generateAnalysis(userData, stressLevel, score),
                    interventions: generateInterventions(stressLevel),
                    tip: generateTip(stressLevel)
                };
            }
            
            return aiResponse;
        }

        // 生成分析结果（模拟AI分析）
        function generateAnalysis(data, stressLevelKey, score) {
            const templates = {
                zh: {
                    'lowStress': `根据评估，${data.name}目前处于低压力状态，这表明您有良好的压力管理能力。您的${data.age}岁年龄和${data.gender}性身份，以及作为${data.occupation}的特点，都为您提供了良好的心理韧性基础。建议继续保持当前的健康生活方式。`,
                    'mediumStress': `根据评估，${data.name}目前处于中等压力状态。作为${data.age}岁的${data.gender}性${data.occupation}，您可能面临一些学业或生活压力，但整体状况可控。建议适当调整生活方式，增加自然接触时间，有助于进一步改善压力状况。`,
                    'highStress': `根据评估，${data.name}目前处于高压力状态，需要重点关注。作为${data.age}岁的${data.gender}性${data.occupation}，您可能正面临较大的学业或生活压力。建议立即采取有效的压力管理措施，必要时寻求专业帮助。`
                },
                en: {
                    'lowStress': `Based on the assessment, ${data.name} is currently in a low stress state, indicating good stress management abilities. Your age of ${data.age} and role as a ${data.occupation} provide a solid foundation for psychological resilience. We recommend continuing your current healthy lifestyle.`,
                    'mediumStress': `Based on the assessment, ${data.name} is currently in a moderate stress state. As a ${data.age}-year-old ${data.occupation}, you may be facing some academic or life pressures, but the overall situation is manageable. We recommend adjusting your lifestyle and increasing contact with nature to further improve your stress condition.`,
                    'highStress': `Based on the assessment, ${data.name} is currently in a high stress state that requires attention. As a ${data.age}-year-old ${data.occupation}, you may be facing significant academic or life pressures. We recommend taking effective stress management measures immediately and seeking professional help if necessary.`
                }
            };
            return templates[currentLang][stressLevelKey] || templates[currentLang]['mediumStress'];
        }

        // 生成干预建议
        function generateInterventions(stressLevelKey) {
            const interventions = {
                zh: {
                    'lowStress': [
                        {
                            method: "日常自然接触维护",
                            effect: "通过定期接触自然环境，维持当前良好的心理状态",
                            reason: "适合您当前的低压力状态，有助于预防压力积累"
                        },
                        {
                            method: "正念冥想练习",
                            effect: "进一步提升自我意识和情绪调节能力",
                            reason: "您已有良好的压力管理基础，可以进一步优化"
                        },
                        {
                            method: "帮助他人减压",
                            effect: "通过帮助他人，增强自我价值感和心理韧性",
                            reason: "您的良好状态可以成为他人的支持力量"
                        }
                    ],
                    'mediumStress': [
                        {
                            method: "每日15分钟森林浴冥想",
                            effect: "通过想象或实际接触森林环境，降低皮质醇水平，缓解焦虑情绪",
                            reason: "适合您的中等压力水平，能有效缓解当前症状"
                        },
                        {
                            method: "自然声音辅助睡眠",
                            effect: "使用雨声、溪流等自然声音改善睡眠质量，减少入睡时间",
                            reason: "睡眠质量改善对中等压力水平的学生特别有效"
                        },
                        {
                            method: "室内植物养护",
                            effect: "在学习环境中摆放绿植，提升空气质量，增强成就感",
                            reason: "适合学生群体，易于实施且效果显著"
                        }
                    ],
                    'highStress': [
                        {
                            method: "专业心理咨询",
                            effect: "通过专业指导，快速缓解高压力状态，恢复心理平衡",
                            reason: "高压力状态需要专业干预，确保安全有效"
                        },
                        {
                            method: "渐进式放松训练",
                            effect: "通过系统性的放松练习，逐步降低身体紧张度",
                            reason: "适合高压力状态，能快速产生缓解效果"
                        },
                        {
                            method: "社交支持网络",
                            effect: "建立和利用社交支持，获得情感支持和实际帮助",
                            reason: "高压力状态下，社会支持是重要的缓解因素"
                        }
                    ]
                },
                en: {
                    'lowStress': [
                        {
                            method: "Daily Nature Contact Maintenance",
                            effect: "Maintain your current good mental state through regular contact with natural environments",
                            reason: "Suitable for your current low stress state, helps prevent stress accumulation"
                        },
                        {
                            method: "Mindfulness Meditation Practice",
                            effect: "Further enhance self-awareness and emotional regulation abilities",
                            reason: "You already have a good stress management foundation, this can further optimize it"
                        },
                        {
                            method: "Help Others Reduce Stress",
                            effect: "Enhance self-worth and psychological resilience by helping others",
                            reason: "Your good state can become a source of support for others"
                        }
                    ],
                    'mediumStress': [
                        {
                            method: "15-Minute Daily Forest Bathing Meditation",
                            effect: "Lower cortisol levels and relieve anxiety through imagining or actually experiencing forest environments",
                            reason: "Suitable for your moderate stress level, can effectively relieve current symptoms"
                        },
                        {
                            method: "Natural Sounds for Sleep",
                            effect: "Use rain, stream, and other natural sounds to improve sleep quality and reduce time to fall asleep",
                            reason: "Improving sleep quality is particularly effective for students with moderate stress levels"
                        },
                        {
                            method: "Indoor Plant Care",
                            effect: "Place green plants in your study environment to improve air quality and enhance sense of achievement",
                            reason: "Suitable for students, easy to implement with significant effects"
                        }
                    ],
                    'highStress': [
                        {
                            method: "Professional Psychological Counseling",
                            effect: "Quickly relieve high stress state and restore psychological balance through professional guidance",
                            reason: "High stress states require professional intervention to ensure safety and effectiveness"
                        },
                        {
                            method: "Progressive Relaxation Training",
                            effect: "Gradually reduce body tension through systematic relaxation exercises",
                            reason: "Suitable for high stress states, can quickly produce relief effects"
                        },
                        {
                            method: "Social Support Network",
                            effect: "Build and utilize social support to gain emotional support and practical help",
                            reason: "Social support is an important relief factor in high stress states"
                        }
                    ]
                }
            };
            return interventions[currentLang][stressLevelKey] || interventions[currentLang]['mediumStress'];
        }

        // 生成日常小贴士
        function generateTip(stressLevelKey) {
            const tips = {
                zh: {
                    'lowStress': "继续保持'微自然'接触习惯：每天至少30分钟的自然环境接触，可以通过窗外观景、桌面植物、自然图片屏保等方式实现。这种持续的自然接触能有效预防压力积累，维持良好的心理状态。",
                    'mediumStress': "尝试'3-3-3'自然接触法：每天3次，每次3分钟，通过3种不同的方式接触自然（如看窗外风景、听自然声音、触摸植物）。这种规律性的自然接触能显著降低中等压力水平，改善整体心理健康。",
                    'highStress': "实施'紧急自然疗法'：当感到压力过大时，立即进行5分钟的自然接触（如深呼吸、看绿色植物、听自然声音），然后进行10分钟的渐进式肌肉放松。这种组合疗法能在短时间内有效缓解高压力状态。"
                },
                en: {
                    'lowStress': "Continue your 'micro-nature' contact habit: at least 30 minutes of natural environment contact daily, through window views, desktop plants, nature screensavers, etc. This continuous nature contact effectively prevents stress accumulation and maintains good mental health.",
                    'mediumStress': "Try the '3-3-3' nature contact method: 3 times a day, 3 minutes each time, through 3 different ways of contacting nature (such as looking at scenery outside the window, listening to natural sounds, touching plants). This regular nature contact can significantly reduce moderate stress levels and improve overall mental health.",
                    'highStress': "Implement 'emergency nature therapy': when feeling overwhelmed, immediately engage in 5 minutes of nature contact (such as deep breathing, looking at green plants, listening to natural sounds), then do 10 minutes of progressive muscle relaxation. This combination therapy can effectively relieve high stress states in a short time."
                }
            };
            return tips[currentLang][stressLevelKey] || tips[currentLang]['mediumStress'];
        }

        // 聊天功能
        async function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            if (!message) return;
            
            const chatMessagesEl = document.getElementById('chat-messages');
            const userLabel = currentLang === 'zh' ? '您' : 'You';
            const aiLabel = currentLang === 'zh' ? 'AI助手' : 'AI Assistant';
            
            // 添加用户消息
            chatMessagesEl.innerHTML += `
                <div class="message user">
                    <strong>${userLabel}：</strong>${message}
                </div>
            `;
            
            // 添加到聊天记录
            chatMessages.push({ role: 'user', content: message });
            
            input.value = '';
            
            // 显示加载状态
            chatMessagesEl.innerHTML += `
                <div class="message bot">
                    <strong>${aiLabel}：</strong><span class="loading-text">${getText('thinking')}</span>
                </div>
            `;
            
            // 滚动到底部
            chatMessagesEl.scrollTop = chatMessagesEl.scrollHeight;
            
            try {
                // 调用DeepSeek API进行聊天
                const response = await fetch(CONFIG.DEEPSEEK_API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${CONFIG.DEEPSEEK_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'deepseek-chat',
                        messages: [
                            { role: 'system', content: currentLang === 'zh' 
                                ? '你是一位专业的自然疗法心理咨询师，擅长帮助学生缓解压力。请用温暖、专业的语气回答学生的问题，并提供实用的建议。'
                                : 'You are a professional natural therapy psychological counselor who specializes in helping students relieve stress. Please answer students\' questions in a warm and professional tone and provide practical advice.'
                            },
                            ...chatMessages
                        ],
                        temperature: 0.7,
                        max_tokens: 500
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`API请求失败: ${response.status}`);
                }
                
                const data = await response.json();
                const botReply = data.choices[0].message.content;
                
                // 更新聊天记录
                chatMessages.push({ role: 'assistant', content: botReply });
                
                // 移除加载状态，添加AI回复
                const loadingMessage = chatMessagesEl.lastElementChild;
                loadingMessage.innerHTML = `<strong>${aiLabel}：</strong>${botReply}`;
                
            } catch (error) {
                console.error('聊天API调用失败:', error);
                
                // 使用备用回复
                const responses = currentLang === 'zh' ? [
                    "我理解您的感受。根据您的评估结果，建议您尝试我们推荐的干预方案。",
                    "压力管理是一个过程，需要时间和耐心。您可以先从简单的自然接触开始。",
                    "如果您感到压力过大，建议寻求专业心理咨询师的帮助。",
                    "记住，您并不孤单。很多学生都面临类似的压力，重要的是找到适合自己的应对方式。",
                    "自然疗法是一个很好的选择，它没有副作用，而且效果持久。"
                ] : [
                    "I understand how you feel. Based on your assessment results, I recommend trying our suggested intervention plans.",
                    "Stress management is a process that takes time and patience. You can start with simple nature contact.",
                    "If you feel overwhelmed, I recommend seeking help from a professional psychological counselor.",
                    "Remember, you are not alone. Many students face similar pressures. The important thing is to find coping methods that work for you.",
                    "Natural therapy is a great choice - it has no side effects and provides lasting results."
                ];
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                
                const loadingMessage = chatMessagesEl.lastElementChild;
                loadingMessage.innerHTML = `<strong>${aiLabel}：</strong>${randomResponse}`;
                
                chatMessages.push({ role: 'assistant', content: randomResponse });
            }
            
            // 滚动到底部
            chatMessagesEl.scrollTop = chatMessagesEl.scrollHeight;
            
            // 限制聊天记录长度
            if (chatMessages.length > CONFIG.MAX_CHAT_MESSAGES) {
                chatMessages.splice(0, chatMessages.length - CONFIG.MAX_CHAT_MESSAGES);
            }
        }

        // 回车发送消息
        document.addEventListener('keypress', function(e) {
            if (e.target.id === 'chat-input' && e.key === 'Enter') {
                sendMessage();
            }
        });

        // 页面加载完成后的初始化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('MindGarden平台已加载完成');
            
            // 从localStorage读取语言偏好
            const savedLang = localStorage.getItem('mindgarden-lang');
            if (savedLang && (savedLang === 'zh' || savedLang === 'en')) {
                switchLanguage(savedLang);
            }

            // 初始化滚动动画
            initScrollAnimations();
            
            // 初始化数字递增动画
            initCounterAnimations();
        });

        // 滚动动画
        function initScrollAnimations() {
            // 为需要动画的元素添加类
            const animateElements = document.querySelectorAll('.card, .intervention-card, .question, .stat-item');
            animateElements.forEach((el, index) => {
                el.classList.add('animate-on-scroll', 'fade-up');
                el.classList.add('delay-' + ((index % 4) + 1));
            });

            // 创建 Intersection Observer
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('animated');
                        // 如果是统计数字，触发计数动画
                        const statNumber = entry.target.querySelector('.stat-number');
                        if (statNumber && !statNumber.dataset.counted) {
                            animateCounter(statNumber);
                            statNumber.dataset.counted = 'true';
                        }
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            });

            // 观察所有动画元素
            document.querySelectorAll('.animate-on-scroll').forEach(el => {
                observer.observe(el);
            });
        }

        // 数字递增动画
        function initCounterAnimations() {
            // 为统计数字添加观察
            const statNumbers = document.querySelectorAll('.stat-number');
            statNumbers.forEach(el => {
                el.dataset.target = el.textContent;
            });
        }

        function animateCounter(element) {
            const target = parseInt(element.dataset.target);
            const duration = 1500;
            const step = target / (duration / 16);
            let current = 0;

            const timer = setInterval(() => {
                current += step;
                if (current >= target) {
                    element.textContent = target + '%';
                    clearInterval(timer);
                } else {
                    element.textContent = Math.floor(current) + '%';
                }
            }, 16);
        }

        // 页面切换时重置动画
        const originalShowPage = showPage;
        showPage = function(pageId) {
            originalShowPage(pageId);
            
            // 重新初始化当前页面的动画
            setTimeout(() => {
                const currentPage = document.getElementById(pageId);
                if (currentPage) {
                    const elements = currentPage.querySelectorAll('.animate-on-scroll:not(.animated)');
                    elements.forEach(el => {
                        if (isElementInViewport(el)) {
                            el.classList.add('animated');
                        }
                    });
                }
            }, 100);
        };

        function isElementInViewport(el) {
            const rect = el.getBoundingClientRect();
            return (
                rect.top >= 0 &&
                rect.left >= 0 &&
                rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
                rect.right <= (window.innerWidth || document.documentElement.clientWidth)
            );
        }
    </script>
</body>
</html>
